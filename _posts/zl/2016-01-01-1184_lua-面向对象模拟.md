---
layout: post
title: lua-面向对象模拟 
tags: [lua文章]
categories: [topic]
---
<p>Lua 语言本身是非常简单的（相对于 C#，C++，Java …）,由于 Lua 语言的创始人的初衷，就是设计一款简单而又小巧的语言，所以说 Lua语言本身是没有“类和对象”的概念的。</p>
<h2 id="类定义模拟"><a href="#类定义模拟" class="headerlink" title="类定义模拟"></a>类定义模拟</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/></pre></td><td class="code"><pre><span class="line"></span><br/><span class="line">Person = {name, age, gender}	<span class="comment">-- 模拟字段</span></span><br/><span class="line"></span><br/><span class="line">&lt;!<span class="comment">-- more --&gt;</span></span><br/><span class="line">Person.Id = <span class="number">1</span>			<span class="comment">-- 模拟静态变量</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">()</span></span>	<span class="comment">-- 模拟构造函数，通过设置元表的方式</span></span><br/><span class="line">4<span class="keyword">local</span> object = {}</span><br/><span class="line">4<span class="built_in">setmetatable</span>(object, Person)</span><br/><span class="line">4self.<span class="built_in">__index</span> = Person</span><br/><span class="line">4<span class="keyword">return</span> object</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person.Print</span><span class="params">()</span></span>	<span class="comment">-- 模拟类方法</span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;Print something&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:Show</span><span class="params">()</span></span>	<span class="comment">-- 模拟成员方法</span></span><br/><span class="line">4<span class="built_in">print</span>(self.name, self.age, self.gender)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<h3 id="类调用模拟"><a href="#类调用模拟" class="headerlink" title="类调用模拟"></a>类调用模拟</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/></pre></td><td class="code"><pre><span class="line">zak = Person:New()  <span class="comment">-- 创建对象</span></span><br/><span class="line">zak.name = <span class="string">&#34;zak&#34;</span>    <span class="comment">-- 字段使用</span></span><br/><span class="line">zak.age = <span class="number">18</span></span><br/><span class="line">zak.gender = <span class="string">&#34;男&#34;</span></span><br/><span class="line">kyle = Person:New()  <span class="comment">-- 创建对象</span></span><br/><span class="line">kyle.name = <span class="string">&#34;kyle&#34;</span>    <span class="comment">-- 字段使用</span></span><br/><span class="line">kyle.age = <span class="number">16</span></span><br/><span class="line">kyle.gender = <span class="string">&#34;男&#34;</span></span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">print</span>(Person.Id)    <span class="comment">-- 静态字段使用</span></span><br/><span class="line"><span class="built_in">print</span>(zak.Id)</span><br/><span class="line"><span class="built_in">print</span>(kyle.Id)</span><br/><span class="line"></span><br/><span class="line">Person.Print()	    <span class="comment">-- 类方法调用</span></span><br/><span class="line"></span><br/><span class="line">zak:Show()	        <span class="comment">-- 成员方法调用</span></span><br/><span class="line">kyle:Show()</span><br/></pre></td></tr></tbody></table></figure>
<h2 id="继承模拟"><a href="#继承模拟" class="headerlink" title="继承模拟"></a>继承模拟</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/></pre></td><td class="code"><pre><span class="line">Programer = Person:New()	<span class="comment">-- 模拟继承父类</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Programer:New</span><span class="params">()</span></span></span><br/><span class="line">4<span class="keyword">local</span> object = Person:New()</span><br/><span class="line">4<span class="built_in">setmetatable</span>(object, Programer)</span><br/><span class="line">4self.<span class="built_in">__index</span> = Programer</span><br/><span class="line">4<span class="keyword">return</span> object</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Programer:Code</span><span class="params">()</span></span></span><br/><span class="line">4<span class="built_in">print</span>(self.name..<span class="string">&#34; is coding&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">zac = Programer:New()</span><br/><span class="line">zac.name = <span class="string">&#34;zac&#34;</span>	<span class="comment">-- 调用父类成员</span></span><br/><span class="line">zac.age = <span class="number">20</span></span><br/><span class="line">zac.gender = <span class="string">&#34;男&#34;</span></span><br/><span class="line">zac:Show()</span><br/><span class="line">zac:Code()			<span class="comment">-- 调用子类自己成员</span></span><br/></pre></td></tr></tbody></table></figure>
<h2 id="代码分离"><a href="#代码分离" class="headerlink" title="代码分离"></a>代码分离</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/><span class="line">37</span><br/><span class="line">38</span><br/><span class="line">39</span><br/></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Hero.lua</span></span><br/><span class="line">Hero = {name}</span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hero:New</span><span class="params">()</span></span></span><br/><span class="line">4<span class="keyword">local</span> object = {}</span><br/><span class="line">4<span class="built_in">setmetatable</span>(object, self)</span><br/><span class="line">4self.<span class="built_in">__index</span> = self</span><br/><span class="line">4<span class="keyword">return</span> object</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hero:Info</span><span class="params">()</span></span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;Hero&#39;s name : &#34;</span> .. self.name)</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- Enemy.lua</span></span><br/><span class="line">Enemy = {name}</span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Enemy:New</span><span class="params">()</span></span></span><br/><span class="line">4<span class="keyword">local</span> object = {}</span><br/><span class="line">4<span class="built_in">setmetatable</span>(object, self)</span><br/><span class="line">4self.<span class="built_in">__index</span> = self</span><br/><span class="line">4<span class="keyword">return</span> object</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Enemy:Info</span><span class="params">()</span></span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;Enemy&#39;s name : &#34;</span> .. self.name)</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- main.lua</span></span><br/><span class="line"><span class="built_in">dofile</span>(<span class="string">&#34;Hero.lua&#34;</span>)	<span class="comment">-- 引用类，参数为类文件路径</span></span><br/><span class="line"><span class="built_in">dofile</span>(<span class="string">&#34;.\Enemy.lua&#34;</span>)</span><br/><span class="line"></span><br/><span class="line">hero = Hero:New()</span><br/><span class="line">hero.name = <span class="string">&#34;a&#34;</span></span><br/><span class="line">hero:Info()</span><br/><span class="line"></span><br/><span class="line">enemy = Enemy:New()</span><br/><span class="line">enemy.name = <span class="string">&#34;b&#34;</span></span><br/><span class="line">enemy:Info()</span><br/></pre></td></tr></tbody></table></figure>