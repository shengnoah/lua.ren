---
layout: post
title: Lua学习笔记二 
tags: [lua文章]
categories: [topic]
---
<h2 id="while"><a href="#while" class="headerlink" title="while"></a>while</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(条件)</span><br/><span class="line"><span class="keyword">do</span></span><br/><span class="line">  循环体</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>代码示例及结果：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">a = <span class="number">0</span></span><br/><span class="line"><span class="keyword">while</span>(a &lt; <span class="number">10</span>)</span><br/><span class="line"><span class="keyword">do</span></span><br/><span class="line">	<span class="built_in">print</span>(a)</span><br/><span class="line">	a = a + <span class="number">1</span></span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line"><span class="number">0</span></span><br/><span class="line"><span class="number">1</span></span><br/><span class="line"><span class="number">2</span></span><br/><span class="line"><span class="number">3</span></span><br/><span class="line"><span class="number">4</span></span><br/><span class="line"><span class="number">5</span></span><br/><span class="line"><span class="number">6</span></span><br/><span class="line"><span class="number">7</span></span><br/><span class="line"><span class="number">8</span></span><br/><span class="line"><span class="number">9</span></span><br/></pre></td></tr></tbody></table></figure>
<h2 id="for"><a href="#for" class="headerlink" title="for"></a>for</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> var=值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">2</span> <span class="keyword">do</span></span><br/><span class="line">  循环体</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>从值1变化到值2，每次变化以值3为步长，执行一次循环体。表达式3不指定时默认为1.</p>
<p>代码示例及结果：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i = <span class="number">0</span>,<span class="number">10</span> <span class="keyword">do</span></span><br/><span class="line">  <span class="built_in">print</span>(i)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">0</span><br/><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td></tr></tbody></table></figure>
<p>变化范围包含值2</p>
<p>for 遍历table:</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">table</span> = {<span class="string">&#34;a&#34;</span>,<span class="string">&#34;b&#34;</span>,<span class="string">&#34;c&#34;</span>}</span><br/><span class="line"><span class="keyword">for</span> i,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(<span class="built_in">table</span>) <span class="keyword">do</span></span><br/><span class="line">  <span class="built_in">print</span>(i,v)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>	a</span><br/><span class="line"><span class="number">2</span>	b</span><br/><span class="line"><span class="number">3</span>	c</span><br/></pre></td></tr></tbody></table></figure>
<h2 id="repeat…until"><a href="#repeat…until" class="headerlink" title="repeat…until"></a>repeat…until</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">repeat</span></span><br/><span class="line">  循环体</span><br/><span class="line"><span class="keyword">until</span>(条件语句)</span><br/></pre></td></tr></tbody></table></figure>
<p>执行循环体，直到条件语句成立</p>
<p>代码示例及结果：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br/><span class="line"><span class="keyword">repeat</span></span><br/><span class="line">  <span class="built_in">print</span>(i)</span><br/><span class="line">  i = i+<span class="number">1</span></span><br/><span class="line"><span class="keyword">until</span>(i&gt;<span class="number">10</span>)</span><br/></pre></td></tr></tbody></table></figure>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line"><span class="number">0</span></span><br/><span class="line"><span class="number">1</span></span><br/><span class="line"><span class="number">2</span></span><br/><span class="line"><span class="number">3</span></span><br/><span class="line"><span class="number">4</span></span><br/><span class="line"><span class="number">5</span></span><br/><span class="line"><span class="number">6</span></span><br/><span class="line"><span class="number">7</span></span><br/><span class="line"><span class="number">8</span></span><br/><span class="line"><span class="number">9</span></span><br/><span class="line"><span class="number">10</span></span><br/></pre></td></tr></tbody></table></figure>
<p>和其他语言一样，break 可以跳出循环。</p>
<h1 id="判断语句"><a href="#判断语句" class="headerlink" title="判断语句"></a>判断语句</h1><h2 id="if"><a href="#if" class="headerlink" title="if"></a>if</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(条件语句)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  	执行语句</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>代码示例及结果：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">a = <span class="number">10</span></span><br/><span class="line"><span class="keyword">if</span>(a&gt;<span class="number">0</span>)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  <span class="built_in">print</span>(<span class="string">&#34;a&gt;0&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p><code>a&gt;0</code></p>
<h2 id="if…else"><a href="#if…else" class="headerlink" title="if…else"></a>if…else</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(条件语句)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  条件为真时语句</span><br/><span class="line"><span class="keyword">else</span></span><br/><span class="line">  条件为假时语句</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>代码示例及结果：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/></pre></td><td class="code"><pre><span class="line">a = <span class="number">10</span></span><br/><span class="line"><span class="keyword">if</span>(a&gt; <span class="number">20</span>)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  <span class="built_in">print</span>(<span class="string">&#34;a&gt;20&#34;</span>)</span><br/><span class="line"><span class="keyword">else</span></span><br/><span class="line">  <span class="built_in">print</span>(<span class="string">&#34;a&lt;=20&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p><code>a&lt;=20</code></p>
<h2 id="if…elseif…else"><a href="#if…elseif…else" class="headerlink" title="if…elseif…else"></a>if…elseif…else</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(条件一)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  条件一为真执行</span><br/><span class="line"><span class="keyword">elseif</span>(条件二)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  条件二为真执行</span><br/><span class="line"><span class="keyword">elseif</span>(条件N)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">  条件N为真执行</span><br/><span class="line"><span class="keyword">else</span></span><br/><span class="line">  以上都不满足的条件执行</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>代码示例及结果：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> score = <span class="number">55</span></span><br/><span class="line"><span class="keyword">if</span>(score &gt;= <span class="number">80</span> <span class="keyword">and</span> score &lt;= <span class="number">100</span>)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">	<span class="built_in">print</span>(<span class="string">&#34;A&#34;</span>)</span><br/><span class="line"><span class="keyword">elseif</span>(score &lt; <span class="number">80</span> <span class="keyword">and</span> score&gt;= <span class="number">60</span>)</span><br/><span class="line"><span class="keyword">then</span></span><br/><span class="line">	<span class="built_in">print</span>(<span class="string">&#34;B&#34;</span>)</span><br/><span class="line"><span class="keyword">else</span></span><br/><span class="line">	<span class="built_in">print</span>(<span class="string">&#34;C&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p><code>c</code></p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">optional_function_scope <span class="function"><span class="keyword">function</span> <span class="params">( argument1, argument2, argument3..., argumentn)</span></span></span><br/><span class="line">    function_body</span><br/><span class="line">    <span class="keyword">return</span> result_params_comma_separated</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<ul>
<li>optional_function_scope 指定函数是全局还是局部函数，默认不写是全局，局部是local</li>
<li>function_name 函数名</li>
<li>argument 参数列表</li>
<li>function_body 函数体</li>
<li>result_params_comma_separated 返回值，可以返回多个值，逗号隔开</li>
</ul>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span><span class="params">(num1,num2)</span></span></span><br/><span class="line">  <span class="keyword">if</span>(num1 &gt; num2)</span><br/><span class="line">  <span class="keyword">then</span></span><br/><span class="line">    result = num1</span><br/><span class="line">  <span class="keyword">else</span></span><br/><span class="line">    result = num2</span><br/><span class="line">  <span class="keyword">end</span></span><br/><span class="line">  <span class="keyword">return</span> result</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>lua 中可以将函数作为参数传递，作为回调函数：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/></pre></td><td class="code"><pre><span class="line"><span class="comment">--登录回调</span></span><br/><span class="line">callback = <span class="function"><span class="keyword">function</span><span class="params">(errorId)</span></span></span><br/><span class="line">  <span class="built_in">print</span>(<span class="string">&#34;errorId:&#34;</span>..errorId)</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"><span class="comment">--登录方法</span></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">(userName,passworld,loginCallback)</span></span></span><br/><span class="line">  <span class="keyword">if</span>(userName == <span class="string">&#34;123&#34;</span> <span class="keyword">and</span> passworld == <span class="string">&#34;123456&#34;</span>) <span class="keyword">then</span></span><br/><span class="line">    loginCallback(<span class="number">0</span>)</span><br/><span class="line">  <span class="keyword">else</span></span><br/><span class="line">    loginCallback(<span class="number">-1</span>)</span><br/><span class="line"> 	<span class="keyword">end</span></span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line">login(<span class="string">&#34;123&#34;</span>,<span class="string">&#34;123456&#34;</span>,callback)</span><br/></pre></td></tr></tbody></table></figure>
<h2 id="返回多值"><a href="#返回多值" class="headerlink" title="返回多值"></a>返回多值</h2><p>如字符换查找，返回开始和结束的位置：(索引从1开始)</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">s,e = <span class="built_in">string</span>.<span class="built_in">find</span>(<span class="string">&#34;hello world&#34;</span>,<span class="string">&#34;world&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(s,e)</span><br/></pre></td></tr></tbody></table></figure>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">maxinum</span><span class="params">(array)</span></span></span><br/><span class="line">  <span class="keyword">local</span> index = <span class="number">1</span></span><br/><span class="line">  <span class="keyword">local</span> <span class="built_in">max</span> = array[index]</span><br/><span class="line">  <span class="keyword">for</span> i,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(array) <span class="keyword">do</span></span><br/><span class="line">    <span class="keyword">if</span>(v &gt; <span class="built_in">max</span>) <span class="keyword">then</span></span><br/><span class="line">      index = i</span><br/><span class="line">      <span class="built_in">max</span> = v</span><br/><span class="line">    <span class="keyword">end</span></span><br/><span class="line">  <span class="keyword">end</span></span><br/><span class="line">  <span class="keyword">return</span> index,<span class="built_in">max</span></span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line">index,<span class="built_in">max</span> = maxinum({<span class="number">3</span>,<span class="number">77</span>,<span class="number">34</span>,<span class="number">22</span>,<span class="number">566</span>,<span class="number">7</span>,<span class="number">32</span>,<span class="number">6</span>})</span><br/><span class="line"><span class="built_in">print</span>(index,<span class="built_in">max</span>)</span><br/></pre></td></tr></tbody></table></figure>
<p><code>5    566</code></p>
<h2 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h2><p>Lua中可变参数和c,java中一样，用三个点…表示</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(...)</span></span></span><br/><span class="line">	sum = <span class="number">0</span></span><br/><span class="line">	<span class="keyword">for</span> i,v <span class="keyword">in</span> <span class="built_in">ipairs</span>{...} <span class="keyword">do</span>	<span class="comment">--{...}表示可变参数的数组</span></span><br/><span class="line">		sum = sum + v</span><br/><span class="line">	<span class="keyword">end</span></span><br/><span class="line">	<span class="keyword">return</span> sum</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br/></pre></td></tr></tbody></table></figure>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">arg</span> = {...} <span class="comment">-- 将可变参数赋值给局部变量</span></span><br/><span class="line">length = #<span class="built_in">arg</span>	<span class="comment">--求可变参数的参数数量</span></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">select</span>(<span class="string">&#39;#&#39;</span>,...) <span class="comment">--求可变参数的参数数量</span></span><br/><span class="line"><span class="built_in">select</span>(n,...)   <span class="comment">-- 访问 n 到 select(&#39;#&#39;,…) 的参数(多个值)</span></span><br/></pre></td></tr></tbody></table></figure>