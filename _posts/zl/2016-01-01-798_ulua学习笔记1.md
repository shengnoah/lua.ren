---
layout: post
title: ulua学习笔记1 
tags: [lua文章]
categories: [topic]
---
<h2 id="本文为bbbbbbion（可以叫我六饼）原创总结，如有疏漏请各位拍砖留言。转载请尊重原作者成果，保留出处。"><a href="#本文为bbbbbbion（可以叫我六饼）原创总结，如有疏漏请各位拍砖留言。转载请尊重原作者成果，保留出处。" class="headerlink" title="本文为bbbbbbion（可以叫我六饼）原创总结，如有疏漏请各位拍砖留言。转载请尊重原作者成果，保留出处。"></a>本文为bbbbbbion（可以叫我六饼）原创总结，如有疏漏请各位拍砖留言。转载请尊重原作者成果，保留出处。</h2><p>这一系列用于记录笔者学习ulua热更新的过程。首先来看Windows下lua环境的搭建。  </p>
<p>环境：lua for windows (lfW)<br/>主页：<a href="http://luaforwindows.luaforge.net/" target="_blank" rel="external noopener noreferrer">http://luaforwindows.luaforge.net/</a>  </p>
<p>lua for windows是一整套Lua的开发环境，主要包括：  </p>
<ul>
<li><p>Lua Interpreter(Lua解释器)</p>
</li>
<li><p>Lua Reference Manual(Lua参考手册)</p>
</li>
<li><p>Quick Lua Tour(Lua快速入门)</p>
</li>
<li><p>Examples(Lua范例)</p>
</li>
<li><p>Librarier with documentation(一些Lua库和文档)</p>
</li>
<li>SciTE(一款多用途编辑器，已经对Lua做了特殊的设置)</li>
</ul>
<p>上述提到的主页上可以下载lfW（需要翻~墙）,最新版本为：5.1.4-46。一路默认安装，最后一步会询问是否使用SciTE默认的“黑色”风格，一般建议勾选。  </p>
<p>使用SciTE:打开SciTE,新建文件，输入print(“hello world”),然后保存为test.lua，注意文件名后缀一定要带上，且为.lua,否则无法正确运行。<br/>然后按F5,结果如图：<br/><img src="https://iningwei.github.io//img/lua hello world.jpg" alt="&#34;Lua Hello world&#34;"/></p>
<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>基础知识以5.1.4-46这个环境下为例。  </p>
<p>1，注释<br/>–单行注释<br/>–[[多行注释，<br/>多行注释]]  </p>
<p>2，变量<br/>—-代码—-<br/>a=1<br/>b=”abc”<br/>c={}<br/>d=print  </p>
<p>print(type(a))<br/>print(type(b))<br/>print(type(c))<br/>print(type(d))</p>
<p>—-输出—-<br/>number<br/>string<br/>table<br/>function</p>
<p>3,变量名称<br/>字符、数字、下划线组成，且不能以数字开头。<br/>以下划线开头的变量通常用于特殊的值，如_VERSION,输出结果为当前Lua的版本。所以变量一般也不以下划线开头。</p>
<p>—-代码—-<br/>print(_VERSIONG)<br/>—-结果—-<br/>Lua 5.1</p>
<p>4,大小写敏感<br/>—-代码—-<br/>ab=1<br/>Ab=2<br/>AB=3<br/>print(ab,Ab,AB)  </p>
<p>—-输出—-<br/>1   2   3</p>
<p>5,关键字<br/>Lua的关键字，如：and,break,do,else,elseif,for,function,if,local,nil,not,or,end,false,in,repeat,return,then,true,until,while。<br/>关键字不能用于变量名。</p>
<p>6,字符串<br/>单行字符串可以用””或’’修饰，若字符串中包含”或’字符，需要使用转义符<br/>多行字符串用[[XXXXXX]]</p>
<p>7,赋值<br/>Lua支持多重赋值。<br/>—-代码—-<br/>a,b,c,d,e=1,2,”three”,”four”,5<br/>print(a,b,c,d,e)<br/>a,b,c,d,e=e,d,c,b,a<br/>print(a,b,c,d,e)</p>
<p>—-输出—-<br/>1   2   three   four   5<br/>5   four   three   2   1  </p>
<p>8,number类型<br/>lua的数字类型都是默认double型，不用担心其精度和处理速度的问题。<br/>—-代码—-<br/>a,b,c,d,e=1,1.123,1E9,-123,.0008<br/>print(“a=”..a,”b=”..b,”c=”..c,”d=”..d,”e=”..e)  –..是字符串连接符</p>
<p>—-输出—-<br/>a=1    b=1.123   c=1000000000   d=-123   e=0.0008</p>
<p>9,打印<br/>print “Hello world!”<br/>print ‘Hello world!’<br/>print(“Hello world!”)<br/>print(‘Hello world!’)</p>
<p>print打印后会换行。</p>
<p>io.write “Hello world!”<br/>io.write ‘Hello world!’<br/>io.write(“Hello world!”)<br/>io.write(‘Hello world!’)</p>
<p>io打印后不换行。</p>
<p>10，Tables<br/>—-代码，简单表的创建—-<br/>a={} –{}创建一个空的表<br/>b={1,2,3} –创建一个表，包含数值1，2，3<br/>c={“a”,”b”,”c”} –创建一个表包含字符串 a,b,c<br/>print(a,b,c) –表不能直接打印，因此结果很诡异</p>
<p>—-输出—-<br/>table:002DBA80 table:002DBAD0 table:002dbaf8</p>
<p>—-代码，访问表—-<br/>address={} –一个空表address<br/>address.Street=”WuHan”<br/>address.Age=”100”<br/>address.Country=”China”  </p>
<p>print(address.Street,address[“Age”],address[“Country”])  </p>
<p>—-输出—-<br/>Wuhan    100    China</p>
<p>11，if语句<br/>—-代码，简单if语句—-  </p>
<pre><code>a=1
if a==1 then
    print(&#34;a is one&#34;)
end
</code></pre><p>—-输出—-<br/>a is one</p>
<p>—-代码，if else—-  </p>
<pre><code>b=&#34;happy&#34;
if b==&#34;sad&#34; then
    print(&#34;b is sad&#34;)
else
    print(&#34;b is not sad&#34;)
end
</code></pre><p>—-输出—-<br/>b is not sad</p>
<p>—-代码，if elseif else—-  </p>
<pre><code>c=3
if c==1 then
    print(&#34;c is 1&#34;)
elseif c==2 then
    print(&#34;c is 2&#34;)
else
    print(&#34;c is not 1 or 2,c is&#34;..tostring(c)) --也可以用print(&#34;c is not 1 or 2,c is&#34;..c)
end
</code></pre><p>—-输出—-<br/>c is not 1 or 2,c is 3</p>
<p>12,while语句<br/>—-代码—-  </p>
<pre><code>a=1
while a~=5 do --Lua use ~= to mean not equal
    a=a+1
    io.write(a..&#34; &#34;)
end
</code></pre><p>—-输出—-<br/>2 3 4 5</p>
<p>13,repeat until语句<br/>—-代码—-  </p>
<pre><code>a=0
repeat 
    a=a+1
    print(a)
until a==5
</code></pre><p>—-输出—-<br/>1<br/>2<br/>3<br/>4<br/>5  </p>
<p>可以发现，repeat until语句不需要使用end</p>
<p>14,for语句<br/>—-代码—-  </p>
<pre><code>for a=1,4           --从1输出4，每次递增1
    do io.write(a..&#34; &#34;)
end

print()

for a=1,6,3
    do io.write(a..&#34; &#34;)
end

for key,value in pairs({1,21,3,4})
    do print(key,value)
end
</code></pre><p>—-输出—-<br/>1 2 3 4<br/>1 4<br/>1    1<br/>2    21<br/>3    3<br/>4    4</p>
<p>15,打印表<br/>—-代码—-  </p>
<pre><code>a={1,2,3,4,&#34;five&#34;,&#34;elephant&#34;,&#34;mouse&#34;}
for i,v in ipairs(a)
    do print(i,v)
end
</code></pre><p>—-输出—-<br/>1    1<br/>2    2<br/>3    3<br/>4    4<br/>5    five<br/>6    elephant<br/>7    mouse</p>
<p>16,break语句<br/>–break用于跳出循环<br/>—-代码—-</p>
<pre><code>a=0
while true do
    a=a+1
    if    a==10 then
        break
    end
end
print(a)
</code></pre><p>—-输出—-<br/>10</p>
<p>17，函数<br/>–定义一个无参数，无返回值的函数。  </p>
<pre><code>function myFirstLuaFunction()
    print(&#34;My first lua function was called&#34;)
end
</code></pre><p>–定义一个有返回值的函数<br/>    function mySecondLuaFunction()<br/>        return “string from my second function”<br/>    end<br/>–第一有参数，有返回值的函数<br/>    function myThirdLuaFunction(a,b,c)<br/>        return a,b,c,“a string”,1,true<br/>    end</p>
<p>–调用函数<br/>    myFirstLuaFunction()<br/>    mySecondLuaFunction()<br/>    myThirdLuaFunction(1,2,”three”)</p>
<p>18,变量作用域<br/>默认变量的作用域为全局的，只有前面加了local标识的变量才是局部的。</p>
<p>19,格式化打印<br/>—-代码—-  </p>
<pre><code>function printf(fmt,...)
    io.write(string.format(fmt,...))
end
printf(&#34;Hello %s from %s on %sn&#34;,os.getenv &#34;USER&#34; or &#34;there&#34;,_VERSION,os.date())
</code></pre><p>—-输出—-<br/>Hello there from Lua 5.1 on 09/03/15 16:55:59</p>
<p>20,Lua库</p>
<ul>
<li><p>math库:<br/>math.abs,math.acos,math.cos,math.deg,math.exp,math.ceil,math.floor,math.fmod,math.log,math.log10,math.min,math.max,math.modf,math.pi,math.pow,math.rad,math.random,math.sqrt,math.randomseed等。</p>
</li>
<li><p>string库:<br/>string.byte,string.char,string.dump,string.find,string.format,string.gfind,string.gsub,string.len,string.lower,string.match,string.rep,string.reverse,string.sub,string.upper</p>
</li>
<li><p>table库：<br/>table.concat,table.insert,table.maxn,table.remove,table.sort<br/>—-代码—-  </p>
<p>  a={2}<br/>  table.insert(a,3);<br/>  table.insert(a,4);<br/>  table.sort(a,function(v1,v2) return v1&gt;v2 end)<br/>  for i,v in ipairs(a) do print(i,v) end</p>
</li>
</ul>
<p>—-输出—-<br/>1    4<br/>2    3<br/>3    2</p>
<p>21,标准库-input/output<br/>io.close,io.flush,io.input,io.lines,io.open,io.output,io.popen,io.read,io.stderr,io.stdout,io.tmpfile,io.type,io.write,<br/>file:close,file:flush,file:line,file:read,file:seek,file:setvbuf,file:write  </p>
<p>22,标准库-os相关<br/>os.clock,os.date,os.difftime,os.execute,os.exit,os.getenv,os.remove,os.rename,os.setlocale,os.time,os.tmpname<br/>—-代码—-<br/>print(os.date())<br/>—-输出—-<br/>09/03/15 22:48:22</p>
<p>23,外部库<br/>–Lua通过使用require()来引用外部模块。<br/>—-代码—-  </p>
<pre><code>require(&#34;iuplua&#34;)
ml=iup.multiline
{
    expand=&#34;YES&#34;
    value=&#34;quit this multiline edit app to continue Tutorial!&#34;
    border=&#34;YES&#34;
}

dlg=iup.dialog{ml;title=&#34;IupMultiline&#34;,size=&#34;QUARTERxQUARTER&#34;,}  
dlg:show()  
print(&#34;Exit GUI app to continue!&#34;)
iup.MainLoop()
</code></pre><p>补充：</p>
<ul>
<li><p>1，pairs和ipairs<br/>ipairs(t):<br/>for i,v in ipairs(t) do body end<br/>will iterate over the pairs(1,t[1]),(2,t[2]),…,up to the first integer key absent from the table.（特别要注意这里index是从1开始的，也即lua的下标是从1开始的）</p>
<p>  pairs(t):<br/>  for k,v in pairs(t) do body end<br/>will iterate over all key-value pairs of table t.</p>
</li>
<li><p>2，null在lua中用nil表示，对于布尔类型只有nil和false是false,数字0、空字符串都是true</p>
</li>
</ul>
<ul>
<li>3,lua没有++，+=这些操作符</li>
</ul>
<ul>
<li><p>4，条件表达式中的与、或、非用and、or、not关键字，不可以使用&amp;&amp;、||、！</p>
</li>
<li><p>5，lua中的全局变量实质上被存储在一个叫”_G”的Table中了，比如我们有个全局变量abc，则可以通过_G.abc或者_G[“abc”]来访问这个全局变量。</p>
</li>
</ul>
<p>参考：<br/>Lua5.1在线手册：<a href="http://book.luaer.cn/" target="_blank" rel="external noopener noreferrer">http://book.luaer.cn/</a><br/>云风翻译Lua手册：<a href="http://www.codingnow.com/2000/download/lua_manual.html" target="_blank" rel="external noopener noreferrer">http://www.codingnow.com/2000/download/lua_manual.html</a></p>