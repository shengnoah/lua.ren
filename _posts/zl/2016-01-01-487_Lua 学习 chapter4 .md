---
layout: post
title: Lua 学习 chapter4  
tags: [lua文章]
categories: [topic]
---
<h3 id="目录">目录</h3>
<ol>
  <li>字符串常量</li>
  <li>强制类型转换</li>
  <li>字符串的标准库</li>
  <li>Unicode编码</li>
</ol>

<blockquote>
  <p>I think you should do your best when you are work.</p>
</blockquote>

<h2 id="字符串常量">字符串常量</h2>

<p>在lua中你可以使用一对双引号或者单引号来声明字符串常量。
它们两个是等价的，唯一区别在于，使用双引号声明的字符串中出现单引号，单引号不需要转义。在单引号中出现双引号也是一样的。
Lua中支持C语言的转义字符：</p>
<ol>
  <li>q 响铃</li>
  <li>b 退格</li>
  <li>f 换页</li>
  <li>n 换行</li>
  <li>t 水平制表</li>
  <li>v 垂直制表</li>
  <li> 反斜杠</li>
  <li>&#34; 双引号</li>
  <li>&#39; 单引号</li>
</ol>

<p>在使用长字符串或者多行字符串的时候可以使用,<strong>[[ str]]</strong>这样表示</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">page</span> <span class="o">=</span> <span class="s">[[
fsdfsd
fdsfsd
fsdf
sf
]]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="强制类型转换">强制类型转换</h2>
<p>自动转换类型： 10 .. 2 –&gt; 102 这个102就是字符串；”10” + 1 –&gt; 11.0 算术运算的时候会把字符串自动转换成浮点数。</p>

<p>tonumber() 将字符串装换成数值，如果不能转换就会输出:nill,也可以使用这个来讲各种进制转换成十进制：
tonumber(“100101”,2)  –&gt; 37 等等，如果所转换的数不是这个进制的数，就会返回nil。</p>

<p>tostring() 将数字转换成字符串。</p>

<h2 id="字符串的标准库">字符串的标准库</h2>
<ol>
  <li>string.rep(“abc”,3) –&gt;”abcabcabc” 重复你次所需字符串</li>
  <li>string.reverse(“abc”) –&gt; “cba”  反转</li>
  <li>string.lower(“ABC”) –&gt; “abc” 小写</li>
  <li>string.upper(“abc”) –&gt; “ABC” 大写</li>
  <li>string.sub(“abcdefg”,2,-2) –&gt;”bcdef” 截取字符串，包含2和-2， 函数不会修改原字符串，2表示第二个，-2表示倒数第二个</li>
  <li>string.byte(“abc”,1) –&gt;97  输出第一个数的内部数值表示，默认不带参数输出第一个字符，带1个输出对应位置的谁。两个输出之间的。</li>
  <li>string.char(99,98,97) –&gt; cba 和byte相反</li>
  <li>string.format(“%d”,10) –&gt;10  %s字符串 %x(小写字母的十六进制) %X(大写字母的十六进制) %f浮点数</li>
  <li>string.find(“abcde”,bcd) –&gt;2 4  返回开始到结束</li>
  <li>string.gsub(“hello world”,”ll”,”..”)  –&gt;he..o world 1  将匹配的字符串替换 并输出替换的次数。</li>
</ol>

<p>这个函数都可以通过语法糖来调用：</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kd">local</span> <span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;hello world&#34;</span>
<span class="n">str</span><span class="p">:</span><span class="n">gsub</span><span class="p">(</span><span class="s2">&#34;ll&#34;</span><span class="p">,</span><span class="s2">&#34;..&#34;</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="unicode编码">Unicode编码</h2>
<p>lua5.3开始支持utf-8编码的Unicode字符串标准。在lua中。使用8个字节来编码字符，所以可以向操作其它字符串一样读写和存储utf-8的字符串。
但是在windows中文件名使用utf-16的编码。所以要么使用外部库，要么修改lua的语言标准库。
函数lower、byte、char以及format中的%c都不在适用，因为它们都是针对以一个字节字符，但是utf-8是8个字节，其它的函数以字节为单位索引而不是字符，所以适用。</p>

<ol>
  <li>utf8.len(“fdasf”)  –&gt;5  返回制定字符串中utf-8的字符个数，如果包含无效字符，则会输出nil以及无效字符的位置。</li>
  <li>utf8.char(114) –&gt; r  可以带多个参数，把内部值转换成字符，这里即把Unicode的值，通过utf-8编码展现。</li>
  <li>utf8.codepoint(“r”,1) –&gt;114  类似于string.byte</li>
  <li>utf8.offset(s,5) –&gt;把字符位置转换成字节位置</li>
  <li>string.sub(“asdf”,utf8.offset(s,-2)) –&gt; df</li>
  <li>utf8.codes(“fdsf”)  遍历输出字符，for i,v in utf8.codes(“fdsg”) do print(i,v) end</li>
</ol>


                <hr style="visibility: hidden;"/>
                
                <hr style="visibility: hidden;"/>