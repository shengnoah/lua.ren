---
layout: post
title: Leetcode 399. Evaluate Division 
tags: [lua文章]
categories: [topic]
---
<p>Equations are given in the format A / B = k, where A and B are variables represented as strings, and k is a real number (floating point number). Given some queries, return the answers. If the answer does not exist, return -1.0.<br/><br/>Example:<br/>Given a / b = 2.0, b / c = 3.0.<br/>queries are: a / c = ?, b / a = ?, a / e = ?, a / a = ?, x / x = ? .<br/>return [6.0, 0.5, -1.0, 1.0, -1.0 ].</p>
<p>The input is: vector&lt;pair&lt;string, string&gt;&gt; equations, </p>
<p>vector<double>&amp; values, vector&lt;pair&lt;string, string&gt;&gt; queries , where equations.size() == values.size(), and the values are positive. This represents the equations. Return vector<double>.</double></double></p>
<p>According to the example above:</p>
<p>equations = [ [“a”, “b”], [“b”, “c”] ],</p>
<p>values = [2.0, 3.0],</p>
<p>queries = [ [“a”, “c”], [“b”, “a”], [“a”, “e”], [“a”, “a”], [“x”, “x”] ]. </p>
<p>The input is always valid. You may assume that evaluating the queries will result in no division by zero and there is no contradiction.</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>dfs<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/><span class="line">37</span><br/><span class="line">38</span><br/><span class="line">39</span><br/><span class="line">40</span><br/><span class="line">41</span><br/><span class="line">42</span><br/><span class="line">43</span><br/><span class="line">44</span><br/></pre></td><td class="code"><pre><span class="line">struct node{</span><br/><span class="line">    string num;</span><br/><span class="line">    double v;</span><br/><span class="line">    node(string nn,double vv):num(nn),v(vv){}</span><br/><span class="line">};</span><br/><span class="line">class Solution {</span><br/><span class="line">public:</span><br/><span class="line">    map&lt;string,vector&lt;node&gt; &gt;g;</span><br/><span class="line">    vector&lt;double&gt; calcEquation(vector&lt;pair&lt;string, string&gt;&gt; equations, vector&lt;double&gt;&amp; values, vector&lt;pair&lt;string, string&gt;&gt; queries) {</span><br/><span class="line">        set&lt;string&gt; ss;</span><br/><span class="line">        for(int i=0;i&lt;equations.size();i++){</span><br/><span class="line">            pair&lt;string,string&gt; p=equations[i];</span><br/><span class="line">            g[p.first].push_back(node(p.second,values[i]));</span><br/><span class="line">            g[p.second].push_back(node(p.first,1/values[i]));           </span><br/><span class="line">        }</span><br/><span class="line">        vector&lt;double&gt; answer;</span><br/><span class="line">        set&lt;string&gt; vis;</span><br/><span class="line">        for(auto b:queries)</span><br/><span class="line">        {</span><br/><span class="line">            vis.clear();</span><br/><span class="line">            </span><br/><span class="line">         if(!g.count(b.first)&amp;&amp;!g.count(b.second)) answer.push_back(-1);</span><br/><span class="line">          else answer.push_back(dfs(b.first,b.second,vis));</span><br/><span class="line">            </span><br/><span class="line">        }</span><br/><span class="line">        return answer;</span><br/><span class="line">    }</span><br/><span class="line">    double dfs(string cur,string target,set&lt;string&gt; &amp;vis){</span><br/><span class="line">        if(cur==target) {</span><br/><span class="line">            return 1;</span><br/><span class="line">        }</span><br/><span class="line">        vis.insert(cur);</span><br/><span class="line">        for(int i=0;i&lt;g[cur].size();i++){</span><br/><span class="line">            node t=g[cur][i];</span><br/><span class="line">            if(!vis.count(t.num)) {</span><br/><span class="line">               double d=dfs(t.num,target,vis);//!!</span><br/><span class="line">          if(d&gt;0) return t.v*d;</span><br/><span class="line">            }</span><br/><span class="line">        }</span><br/><span class="line">        return -1;</span><br/><span class="line">       </span><br/><span class="line">    }</span><br/><span class="line">    </span><br/><span class="line">};</span><br/></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/><span class="line">37</span><br/><span class="line">38</span><br/><span class="line">39</span><br/><span class="line">40</span><br/><span class="line">41</span><br/><span class="line">42</span><br/><span class="line">43</span><br/><span class="line">44</span><br/><span class="line">45</span><br/><span class="line">46</span><br/><span class="line">47</span><br/><span class="line">48</span><br/><span class="line">49</span><br/><span class="line">50</span><br/></pre></td><td class="code"><pre><span class="line">struct node{</span><br/><span class="line">    string num;</span><br/><span class="line">    double v;</span><br/><span class="line">    node(string nn,double vv):num(nn),v(vv){}</span><br/><span class="line">};</span><br/><span class="line">class Solution {</span><br/><span class="line">public:</span><br/><span class="line">    map&lt;string,vector&lt;node&gt; &gt;g;</span><br/><span class="line">    vector&lt;double&gt; calcEquation(vector&lt;pair&lt;string, string&gt;&gt; equations, vector&lt;double&gt;&amp; values, vector&lt;pair&lt;string, string&gt;&gt; queries) {</span><br/><span class="line">        set&lt;string&gt; ss;</span><br/><span class="line">        for(int i=0;i&lt;equations.size();i++){</span><br/><span class="line">            pair&lt;string,string&gt; p=equations[i];</span><br/><span class="line">            g[p.first].push_back(node(p.second,values[i]));</span><br/><span class="line">            g[p.second].push_back(node(p.first,1/values[i]));</span><br/><span class="line">            ss.insert(p.first);</span><br/><span class="line">            ss.insert(p.second);            </span><br/><span class="line">        }</span><br/><span class="line">        vector&lt;double&gt; answer;</span><br/><span class="line">        set&lt;string&gt; vis;</span><br/><span class="line">        for(auto b:queries)</span><br/><span class="line">        {</span><br/><span class="line">            vis.clear();</span><br/><span class="line">            double ans=1;</span><br/><span class="line">         if(!ss.count(b.first)&amp;&amp;!ss.count(b.second)) answer.push_back(-1);</span><br/><span class="line">         else if(!dfs(b.first,b.second,vis,ans,answer)) answer.push_back(-1);</span><br/><span class="line">            </span><br/><span class="line">        }</span><br/><span class="line">        return answer;</span><br/><span class="line">    }</span><br/><span class="line">    bool dfs(string cur,string target,set&lt;string&gt; &amp;vis,double &amp;ans,vector&lt;double&gt; &amp;answer){</span><br/><span class="line">        if(vis.count(cur)) return false;</span><br/><span class="line">        if(cur==target) {</span><br/><span class="line">            answer.push_back(ans);</span><br/><span class="line">            return true;</span><br/><span class="line">        }</span><br/><span class="line">        vis.insert(cur);</span><br/><span class="line">        for(int i=0;i&lt;g[cur].size();i++){</span><br/><span class="line">            node t=g[cur][i];</span><br/><span class="line">            if(!vis.count(t.num)) {</span><br/><span class="line">           double tmp=ans*t.v;                </span><br/><span class="line">            if(dfs(t.num,target,vis,tmp,answer)) return true;</span><br/><span class="line">            }</span><br/><span class="line">            </span><br/><span class="line">        }</span><br/><span class="line">        </span><br/><span class="line">        return false;</span><br/><span class="line">       </span><br/><span class="line">    }</span><br/><span class="line">    </span><br/><span class="line">};</span><br/></pre></td></tr></tbody></table></figure>