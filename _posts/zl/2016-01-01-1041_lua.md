---
layout: post
title: lua 
tags: [lua文章]
categories: [topic]
---
<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			
		
		</div>
		
		<h5 id="command"><a href="#command" class="headerlink" title="command"></a>command</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/><span class="line">37</span><br/><span class="line">38</span><br/><span class="line">39</span><br/><span class="line">40</span><br/><span class="line">41</span><br/><span class="line">42</span><br/><span class="line">43</span><br/><span class="line">44</span><br/><span class="line">45</span><br/><span class="line">46</span><br/><span class="line">47</span><br/><span class="line">48</span><br/><span class="line">49</span><br/><span class="line">50</span><br/><span class="line">51</span><br/><span class="line">52</span><br/><span class="line">53</span><br/><span class="line">54</span><br/><span class="line">55</span><br/><span class="line">56</span><br/><span class="line">57</span><br/><span class="line">58</span><br/><span class="line">59</span><br/><span class="line">60</span><br/><span class="line">61</span><br/><span class="line">62</span><br/><span class="line">63</span><br/><span class="line">64</span><br/><span class="line">65</span><br/><span class="line">66</span><br/><span class="line">67</span><br/><span class="line">68</span><br/><span class="line">69</span><br/><span class="line">70</span><br/><span class="line">71</span><br/><span class="line">72</span><br/><span class="line">73</span><br/><span class="line">74</span><br/><span class="line">75</span><br/><span class="line">76</span><br/><span class="line">77</span><br/><span class="line">78</span><br/><span class="line">79</span><br/><span class="line">80</span><br/><span class="line">81</span><br/><span class="line">82</span><br/><span class="line">83</span><br/><span class="line">84</span><br/><span class="line">85</span><br/><span class="line">86</span><br/><span class="line">87</span><br/><span class="line">88</span><br/><span class="line">89</span><br/><span class="line">90</span><br/><span class="line">91</span><br/><span class="line">92</span><br/><span class="line">93</span><br/><span class="line">94</span><br/><span class="line">95</span><br/><span class="line">96</span><br/><span class="line">97</span><br/><span class="line">98</span><br/><span class="line">99</span><br/><span class="line">100</span><br/><span class="line">101</span><br/></pre></td><td class="code"><pre><span class="line">command_func = {}</span><br/><span class="line"></span><br/><span class="line">function command_func.help()</span><br/><span class="line">	print(&#34;{&#34;i&#34;, &#34;input&#34;, &#34;require&#34;, &#34;GetFirstInputFile&#34;}&#34;)</span><br/><span class="line">	print(&#34;{&#34;i&#34;, &#34;input&#34;, &#34; no&#34;, &#34;GetFirstInputFile&#34;}&#34;)</span><br/><span class="line">	print(&#34;separator is &#34;#&#34;!&#34;)</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">--将长参数和短参数分开  存到tab中</span><br/><span class="line">function command_func.argToTab(arg)</span><br/><span class="line">	local tabArg = {}</span><br/><span class="line">	local argTabKey = nil</span><br/><span class="line">	for i,v in ipairs(arg) do</span><br/><span class="line">		cFirstChar = string.sub(v, 1, 1)</span><br/><span class="line">		if cFirstChar == &#34;-&#34; then</span><br/><span class="line">			argTabKey = v</span><br/><span class="line">		elseif argTabKey ~= nil then</span><br/><span class="line">			if tabArg[argTabKey] == nil then</span><br/><span class="line">				tabArg[argTabKey] = v</span><br/><span class="line">			else</span><br/><span class="line">				tabArg[argTabKey] =  tabArg[argTabKey] .. &#34;#&#34; ..v</span><br/><span class="line">			end</span><br/><span class="line">		end</span><br/><span class="line">	end</span><br/><span class="line">	return tabArg</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">function command_func.integrationSameMeanArg(tabArg, commandList)</span><br/><span class="line">	if next(tabArg) == nil or next(commandList) == nil then</span><br/><span class="line">		print(&#34;command is error&#34;)</span><br/><span class="line">		return nil</span><br/><span class="line">	end</span><br/><span class="line">	for commandListKey,commandListValue in ipairs(commandList) do</span><br/><span class="line">		flag = false</span><br/><span class="line">		local allCommand = nil</span><br/><span class="line">		for tabArgKey,tabArgValue in pairs(tabArg) do</span><br/><span class="line">			if tabArgKey == commandListValue[1] or tabArgKey == commandListValue[2] then			</span><br/><span class="line">				allCommand = tabArgValue</span><br/><span class="line">			end</span><br/><span class="line">		end</span><br/><span class="line">		tabArg[commandListValue[1]] = allCommand</span><br/><span class="line">		tabArg[commandListValue[2]] = nil</span><br/><span class="line">	end</span><br/><span class="line">	return tabArg</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">function command_func.comandAnalysis(arg, commandList)</span><br/><span class="line">	local argMatchcommandList = false</span><br/><span class="line"></span><br/><span class="line">	local tabArg =  command_func.argToTab(arg)</span><br/><span class="line">	if next(tabArg) == nil then</span><br/><span class="line">		print(&#34;command is empty&#34;)</span><br/><span class="line">		return false</span><br/><span class="line">	end</span><br/><span class="line"></span><br/><span class="line">	local commandList = command_func.processCommandListAndCheckLegality(commandList)</span><br/><span class="line">	if commandList == nil then</span><br/><span class="line">		return false</span><br/><span class="line">	end</span><br/><span class="line"></span><br/><span class="line">	tabArg = command_func.integrationSameMeanArg(tabArg, commandList)</span><br/><span class="line">	if tabArg == nil then</span><br/><span class="line">		return false</span><br/><span class="line">	end</span><br/><span class="line"></span><br/><span class="line">	for commandListKey, commandListValue in ipairs(commandList) do</span><br/><span class="line">		argMatchcommandList = false</span><br/><span class="line">		for tabArgKey, tabArgValue in pairs(tabArg) do</span><br/><span class="line">			if tabArgKey == commandListValue[1] or tabArgKey == commandListValue[2] then</span><br/><span class="line">				commandListValue[4](tabArgValue)</span><br/><span class="line">				argMatchcommandList = true</span><br/><span class="line">			end</span><br/><span class="line">		end</span><br/><span class="line"></span><br/><span class="line">		if commandListValue[3] == &#34;require&#34; and argMatchcommandList == false then					</span><br/><span class="line">			print(&#34;command or commandList is not match!&#34;)</span><br/><span class="line">			return false</span><br/><span class="line">		end</span><br/><span class="line">	end</span><br/><span class="line"></span><br/><span class="line">	return true</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">function  command_func.processCommandListAndCheckLegality(commandList)</span><br/><span class="line">	local commandList1 = commandList</span><br/><span class="line">	if next(commandList1) == nil then</span><br/><span class="line">		print(&#34;commandList is empty&#34;)</span><br/><span class="line">		return nil</span><br/><span class="line">	end</span><br/><span class="line">	for i,v in ipairs(commandList1) do</span><br/><span class="line">		v[1] = &#34;-&#34; .. v[1]</span><br/><span class="line">		v[2] = &#34;--&#34; .. v[2]</span><br/><span class="line">		if v[4] == nil then</span><br/><span class="line">			return nil</span><br/><span class="line">		end</span><br/><span class="line">	end</span><br/><span class="line">	return commandList1</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line">return command_func</span><br/></pre></td></tr></tbody></table></figure>
<h5 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/></pre></td><td class="code"><pre><span class="line">require(&#34;command&#34;)</span><br/><span class="line">local function getFirstFile(firstFileName)</span><br/><span class="line">	print(firstFileName)</span><br/><span class="line">end</span><br/><span class="line">local function getCompareFile(compareFileName)</span><br/><span class="line">	print(compareFileName)</span><br/><span class="line">end</span><br/><span class="line">local function getSecondFile(secondFileName)</span><br/><span class="line">	print(secondFileName)</span><br/><span class="line">end</span><br/><span class="line">argList =</span><br/><span class="line">	{</span><br/><span class="line">		{&#34;i&#34;, &#34;input&#34;, &#34;require&#34;, getFirstFile},</span><br/><span class="line">		{&#34;o&#34;, &#34;output&#34;, &#34;require&#34;, getCompareFile},</span><br/><span class="line">		{&#34;s&#34;, &#34;second&#34;, &#34;no&#34;, getSecondFile},</span><br/><span class="line">	}</span><br/><span class="line"></span><br/><span class="line">local result = command_func.comandAnalysis(arg, argList)</span><br/><span class="line">if result == false then</span><br/><span class="line">	command_func.help()</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<h5 id="compare"><a href="#compare" class="headerlink" title="compare"></a>compare</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/><span class="line">37</span><br/><span class="line">38</span><br/><span class="line">39</span><br/><span class="line">40</span><br/><span class="line">41</span><br/><span class="line">42</span><br/><span class="line">43</span><br/><span class="line">44</span><br/><span class="line">45</span><br/><span class="line">46</span><br/><span class="line">47</span><br/><span class="line">48</span><br/><span class="line">49</span><br/><span class="line">50</span><br/><span class="line">51</span><br/><span class="line">52</span><br/><span class="line">53</span><br/><span class="line">54</span><br/><span class="line">55</span><br/><span class="line">56</span><br/><span class="line">57</span><br/><span class="line">58</span><br/><span class="line">59</span><br/><span class="line">60</span><br/><span class="line">61</span><br/></pre></td><td class="code"><pre><span class="line">strFristFile = arg[1]</span><br/><span class="line">strSecondFile = arg[2]</span><br/><span class="line">strCompareFile = arg[3]</span><br/><span class="line"></span><br/><span class="line">--根据命令行参数输入相关的文件命令</span><br/><span class="line">if strFristFile == nil or strSecondFile == nil then</span><br/><span class="line">	print(&#34;You do not enter the comparison file A or B / A and B, please check the command line parameters!&#34;)</span><br/><span class="line">	return 0</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">filePointerFrist = io.open(strFristFile, &#34;r&#34;)</span><br/><span class="line">filePointerSencond = io.open(strSecondFile, &#34;r&#34;)</span><br/><span class="line">if strCompareFile ~= nil then</span><br/><span class="line">	compareFilePointer = io.open(strCompareFile, &#34;w&#34;)</span><br/><span class="line">else</span><br/><span class="line">	compareFilePointer = io.open(&#34;CompareFile.txt&#34;, &#34;w&#34;)</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">--判断文件是否为空 或者说文件是否打开成功</span><br/><span class="line">if filePointerFrist == nil and filePointerSencond == nil then</span><br/><span class="line">	print(&#34;All files are empty!&#34;)</span><br/><span class="line">	return 0</span><br/><span class="line">elseif filePointerFrist == nil then</span><br/><span class="line">	print(strFristFile, &#34;文件指针为nil!&#34;)</span><br/><span class="line">	return 0</span><br/><span class="line">elseif filePointerSencond == nil then</span><br/><span class="line">	print(strSecondFile, &#34;文件指针为nil!&#34;)</span><br/><span class="line">	return 0</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">--读文件并做比较</span><br/><span class="line">local strFirstLine = filePointerFrist:read(&#34;*l&#34;)</span><br/><span class="line">local strSecondLine = filePointerSencond:read(&#34;*l&#34;)</span><br/><span class="line">while strFirstLine ~= nil and strSecondLine ~= nil do</span><br/><span class="line">	if strFirstLine ~= strSecondLine then</span><br/><span class="line">		compareFilePointer:write(strFristFile, &#34;显示：&#34;&#34;, strFirstLine, &#34; &#34; 和&#34;, strSecondFile, &#34;显示为：&#34; &#34;, strSecondLine, &#34; &#34; 不同n&#34;)</span><br/><span class="line">	end</span><br/><span class="line">	strFirstLine = filePointerFrist:read(&#34;*l&#34;)</span><br/><span class="line">	strSecondLine = filePointerSencond:read(&#34;*l&#34;)</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">--文件行数不一样的情况</span><br/><span class="line">if strFirstLine == nil and strSecondLine == nil then</span><br/><span class="line">	print(&#34;file is null/ line is equal！&#34;)</span><br/><span class="line">elseif strFirstLine == nil then</span><br/><span class="line">	tempLine = strSecondLine;</span><br/><span class="line">	strSecondLine = filePointerSencond:read(&#34;*a&#34;)</span><br/><span class="line">	--Write = tempLine..strSecondLine</span><br/><span class="line">	strWrite = table.concat({tempLine, strSecondLine})</span><br/><span class="line">	compareFilePointer:write(strFristFile, &#34;为空，和&#34;, strSecondFile, &#34;显示为：&#34; &#34;, strWrite, &#34; &#34; 不同n&#34;)</span><br/><span class="line">elseif strSecondLine == nil then</span><br/><span class="line">	tempLine = strFirstLine</span><br/><span class="line">	strFirstLine = filePointerFrist:read(&#34;*a&#34;)</span><br/><span class="line">	--strWrite = tempLine..strFirstLine</span><br/><span class="line">	strWrite = table.concat({tempLine, strFirstLine})</span><br/><span class="line">	compareFilePointer:write(strSecondFile, &#34;为空，和&#34;, strFristFile, &#34;显示为：&#34;&#34;, strWrite, &#34; &#34; 不同n&#34;)</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">filePointerFrist:close()</span><br/><span class="line">filePointerSencond:close()</span><br/><span class="line">compareFilePointer:close()</span><br/></pre></td></tr></tbody></table></figure>