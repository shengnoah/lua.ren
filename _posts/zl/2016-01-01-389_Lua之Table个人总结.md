---
layout: post
title: Lua之Table个人总结 
tags: [lua文章]
categories: [topic]
---
<blockquote>
<p>在lua中Table是数组和集合的混合物。作为数组时，可以使用除了nil以外的值作为索引。</p>
</blockquote>
<hr/>

<h4 id="Table的构造"><a href="#Table的构造" class="headerlink" title="Table的构造"></a>Table的构造</h4><h5 id="利用下标来标明元素"><a href="#利用下标来标明元素" class="headerlink" title="利用下标来标明元素"></a>利用下标来标明元素</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">local table  = {}</span><br/><span class="line">table[1]=&#39;hello&#39;</span><br/><span class="line">table[5]=&#39;world&#39;</span><br/><span class="line">for i,v in pairs(table)do</span><br/><span class="line">    print(table[i])</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">1	hello</span><br/><span class="line">5	world</span><br/></pre></td></tr></tbody></table></figure><p></p>
<h5 id="在Table内部通过索引来声明"><a href="#在Table内部通过索引来声明" class="headerlink" title="在Table内部通过索引来声明"></a>在Table内部通过索引来声明</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">local table = { [1] = &#39;hello&#39;, [5] = &#39;world&#39; }</span><br/><span class="line">for i, v in pairs(table) do</span><br/><span class="line">    print(table[i])</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">1	hello</span><br/><span class="line">5	world</span><br/></pre></td></tr></tbody></table></figure><p></p>
<h5 id="在Table内部不通过索引来声明"><a href="#在Table内部不通过索引来声明" class="headerlink" title="在Table内部不通过索引来声明"></a>在Table内部不通过索引来声明</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">local table = {&#39;hello&#39;,&#39;world&#39;}</span><br/><span class="line">for k, v in pairs(table) do</span><br/><span class="line">    print(k,v)</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">1	hello</span><br/><span class="line">2	world</span><br/></pre></td></tr></tbody></table></figure><p></p>
<hr/>
<p>Note:</p>
<p>1，可以看到通过下标标明元素（方法1）和在内部通过索引方式（方法2）构造的table是一样的。如果不声明索引（方法3），则默认为数字，且从1开始。</p>
<p>2，索引可以为字符串。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">local table  = {}</span><br/><span class="line">table[1]=&#39;hello&#39;</span><br/><span class="line">table[&#34;skr&#34;]=&#39;world&#39;</span><br/><span class="line">for k, v in pairs(table) do</span><br/><span class="line">    print(k,v)</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<p>或者是<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">local table = { [1] = &#39;hello&#39;, skr = &#34;world&#34; }</span><br/><span class="line">for k, v in pairs(table) do</span><br/><span class="line">    print(k, v)</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">1	hello</span><br/><span class="line">skr	world</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>这时table有点像Java的HashMap，下标作为key。</p>
<p>3，如果索引为数字访问方式为 table[1]<br/>如果索引为其他类型，访问方式为 table.skr 或者是 table[‘skr’]（注意 [ ] 内为字符串，两侧有引号）</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">print(table[1])         --输出hello</span><br/><span class="line">print(table.skr)       --输出world</span><br/><span class="line">print(table[skr])      --输出nil（没有引号，错误）</span><br/><span class="line">print(table[&#39;skr&#39;])     --输出world（有引号，正确）</span><br/></pre></td></tr></tbody></table></figure>
<p>4，#运算符</p>
<p>利用#运算符可以获得table中使用数字做key的元素总数。<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">local table = { [1] = &#39;hello&#39;, skr = &#34;world&#34;, _2 = &#34;123&#34; }</span><br/><span class="line">print(#table)  --输出1，只有索引为1的元素才会被计算，skr和_2都是字符串</span><br/></pre></td></tr></tbody></table></figure><p></p>
<hr/>
<h4 id="Table的其他用法"><a href="#Table的其他用法" class="headerlink" title="Table的其他用法"></a>Table的其他用法</h4><p>上面的例子可以看到，Lua的Table，索引Key为数字时像Java的ArrayList，索引为字符串的时候像Java的HashMap。Java的HashMap可以存储对象，Lua的Table也可以。<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/></pre></td><td class="code"><pre><span class="line">local CPU = { name = &#39;CPU&#39;, cost = 400 }</span><br/><span class="line">local Monitor = { name = &#39;bird&#39;, cost = 200 }</span><br/><span class="line">local Memory = { name = &#39;memory&#39;, cost = 100 }</span><br/><span class="line">local Computer = {</span><br/><span class="line">    CPU,</span><br/><span class="line">    cpu = Monitor</span><br/><span class="line">}</span><br/><span class="line">Computer.memory = Memory</span><br/><span class="line">Computer[6] = Memory</span><br/><span class="line"></span><br/><span class="line">for k, v in pairs(Computer) do</span><br/><span class="line">    print(k, v.name, v.cost)</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">1	CPU	400   --数字索引</span><br/><span class="line">cpu	bird	200	2   --字符串索引</span><br/><span class="line">6	memory	100	2   --数字索引，构造后添加</span><br/><span class="line">memory	memory	100	4      --字符串索引，构造后添加</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>Table中利用索引存储Table，这种思想类似面向对象的封装。而对象是由属性和方法组成，在Lua中，对象由Table作属性，function作方法，共同组成对象。<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/></pre></td><td class="code"><pre><span class="line">local CPU = { name = &#39;CPU&#39;, cost = 400 }</span><br/><span class="line">local Monitor = { name = &#39;bird&#39;, cost = 200 }</span><br/><span class="line">local Memory = { name = &#39;memory&#39;, cost = 100 }</span><br/><span class="line">local Computer = {</span><br/><span class="line">    description = &#34;this is a computer&#34;,</span><br/><span class="line">    cpu = CPU,</span><br/><span class="line">    monitor = Monitor,</span><br/><span class="line">    memory = Memory</span><br/><span class="line">}</span><br/><span class="line"></span><br/><span class="line">function Computer.getDescription()</span><br/><span class="line">    return Computer.description</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">print(Computer.getDescription())</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">this is a computer</span><br/></pre></td></tr></tbody></table></figure><p></p>
<h4 id="Table的常用方法"><a href="#Table的常用方法" class="headerlink" title="Table的常用方法"></a>Table的常用方法</h4><blockquote>
<p>这些方法的使用类似Java的静态方法</p>
</blockquote>
<h5 id="table-insert-table-pos-value-往table中第pos中插入value的值。如果pos已存在，则往后移动。"><a href="#table-insert-table-pos-value-往table中第pos中插入value的值。如果pos已存在，则往后移动。" class="headerlink" title="table.insert(table,pos,value):往table中第pos中插入value的值。如果pos已存在，则往后移动。"></a>table.insert(table,pos,value):往table中第pos中插入value的值。如果pos已存在，则往后移动。</h5><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line">print(&#39;before insert&#39;)</span><br/><span class="line">local tb = { &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;5&#39; }</span><br/><span class="line">for k, v in pairs(tb) do</span><br/><span class="line">    print(k, v)</span><br/><span class="line">end</span><br/><span class="line">table.insert(tb, 2, &#39;6&#39;)</span><br/><span class="line">print(&#39;after insert&#39;)</span><br/><span class="line">for k, v in pairs(tb) do</span><br/><span class="line">    print(k, v)</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<p>输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">before insert</span><br/><span class="line">1	1</span><br/><span class="line">2	2</span><br/><span class="line">3	3</span><br/><span class="line">4	5</span><br/><span class="line">after insert</span><br/><span class="line">1	1</span><br/><span class="line">2	6</span><br/><span class="line">3	2</span><br/><span class="line">4	3</span><br/><span class="line">5	5</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>往tb中index=2的地方插入了6，原来index=2的位置变成了3。类似Java的list.add(index,object).</p>
<p>如果没有索引，则往最后的地方插入。类似Java的list.add(object)</p>
<p>pos，否则会报错。</p>
<h5 id="table-remove-table-pos-和insert类似"><a href="#table-remove-table-pos-和insert类似" class="headerlink" title="table.remove(table,pos):和insert类似"></a>table.remove(table,pos):和insert类似</h5><h5 id="table-sort-table-排序规则"><a href="#table-sort-table-排序规则" class="headerlink" title="table.sort(table, 排序规则)"></a>table.sort(table, 排序规则)</h5><p>排序规则为自定义排序规则，缺省为升序</p>
<p>下面的例子是定义了一个排序规则为年龄降序的排序。<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/></pre></td><td class="code"><pre><span class="line">local people = {</span><br/><span class="line">    { name = &#39;a&#39;, age = 11 },</span><br/><span class="line">    { name = &#39;b&#39;, age = 14 },</span><br/><span class="line">    { name = &#39;c&#39;, age = 12 },</span><br/><span class="line">    { name = &#39;d&#39;, age = 10 },</span><br/><span class="line">}</span><br/><span class="line"></span><br/><span class="line">function sortByAge(a, b)</span><br/><span class="line">    return a.age &gt; b.age</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">function printArray(showText, array)</span><br/><span class="line">    print(showText)</span><br/><span class="line">    for i, v in ipairs(array) do</span><br/><span class="line">        print(v.name, v.age)</span><br/><span class="line">    end</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">printArray(&#39;before&#39;, people)</span><br/><span class="line">table.sort(people, sortByAge)</span><br/><span class="line">printArray(&#39;after&#39;, people)</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>其中sortByAge(object1,object2)需要传入两个对象。如果返回true的话就交换位置，由于这里用的是大于，则表示从大到小排序，则为降序。输出结果为：<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line">before</span><br/><span class="line">a	11</span><br/><span class="line">b	14</span><br/><span class="line">c	12</span><br/><span class="line">d	10</span><br/><span class="line">after</span><br/><span class="line">b	14</span><br/><span class="line">c	12</span><br/><span class="line">a	11</span><br/><span class="line">d	10</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>如果改变排序规则，比较名字。使用升序，输出应该为abcd<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line">function sortByName(a, b)</span><br/><span class="line">    return a.name &lt; b.name</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>输出的确为a-b-c-d<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">after</span><br/><span class="line">a	11</span><br/><span class="line">b	14</span><br/><span class="line">c	12</span><br/><span class="line">d	10</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>另外，字符串的排序应该是按照首个字符的AscII码排序。<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">local people = {</span><br/><span class="line">    { name = &#39;+a&#39;, age = 11 },</span><br/><span class="line">    { name = &#39;ab&#39;, age = 14 },</span><br/><span class="line">    { name = &#39;Dc&#39;, age = 12 },</span><br/><span class="line">    { name = &#39;9d&#39;, age = 10 },</span><br/><span class="line">}</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>其中+的Ascii码为43，a为97，D为68，9为57，输出结果为<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">after</span><br/><span class="line">+a	11</span><br/><span class="line">9d	10</span><br/><span class="line">Dc	12</span><br/><span class="line">ab	14</span><br/></pre></td></tr></tbody></table></figure><p></p>
<h5 id="table-concat-table-间隔符-start-end"><a href="#table-concat-table-间隔符-start-end" class="headerlink" title="table.concat(table[,间隔符[,start[,end]]])"></a>table.concat(table[,间隔符[,start[,end]]])</h5><p>把table内部的元素从start开始到end，以 间隔符 拼接，拼接后的对象属性为String<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/></pre></td><td class="code"><pre><span class="line">local tb = {&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;}</span><br/><span class="line">local s1 = table.concat(tb,&#39;*&#39;,2,3)</span><br/><span class="line">local s2 = table.concat(tb)</span><br/><span class="line">print(s1)</span><br/><span class="line">print(type(s1))</span><br/><span class="line">print(s2)</span><br/><span class="line">print(type(s2))</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>上面展示了把table的每个元素拼接，元素之间以 * 和 ‘’(空字符串) 间隔，输出<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">2*3  --从第二到第三个元素，期间以*连接</span><br/><span class="line">string</span><br/><span class="line">1234    --不带参数表示从头到尾，以空字符串连接</span><br/><span class="line">string</span><br/></pre></td></tr></tbody></table></figure><p></p>