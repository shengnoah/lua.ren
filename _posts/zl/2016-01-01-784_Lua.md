---
layout: post
title: Lua 
tags: [lua文章]
categories: [topic]
---
<h2 id="table-操作"><a href="#table-操作" class="headerlink" title="table 操作"></a>table 操作</h2>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">table.concat (table [, step [, start [, end]]])</td>
<td style="text-align:left">函数列出参数中指定table的数组部分从start位置到end位置的所有元素, 元素间以指定的分隔符(step)隔开</td>
</tr>
<tr>
<td style="text-align:center">table.insert (table, [pos,] value)</td>
<td style="text-align:left">在table的数组部分指定位置(pos)插入值为value的一个元素. pos参数可选, 默认为数组部分末尾</td>
</tr>
<tr>
<td style="text-align:center">table.maxn(table)</td>
<td style="text-align:left">指定table中所有正数key值中最大的key值. 如果不存在key值为正数的元素, 则返回0。(Lua5.2之后该方法已经不存在了)</td>
</tr>
<tr>
<td style="text-align:center">table.remove (table [, pos])</td>
<td style="text-align:left">返回table数组部分位于pos位置的元素. 其后的元素会被前移. pos参数可选, 默认为table长度, 即从最后一个元素删起。</td>
</tr>
<tr>
<td style="text-align:center">table.sort (table [, comp])</td>
<td style="text-align:left">对给定的table进行升序排序。</td>
</tr>
<tr>
<td style="text-align:center">table.getn(tableName)</td>
<td style="text-align:left">获取表的长度</td>
</tr>
</tbody>
</table>
</div>
<h2 id="操作示例"><a href="#操作示例" class="headerlink" title="操作示例"></a>操作示例</h2><ol>
<li>table.concat</li>
</ol>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/></pre></td><td class="code"><pre><span class="line">fruits = {<span class="string">&#34;banana&#34;</span>,<span class="string">&#34;orange&#34;</span>,<span class="string">&#34;apple&#34;</span>}</span><br/><span class="line"></span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;连接后的字符串 &#34;</span>,<span class="built_in">table</span>.<span class="built_in">concat</span>(fruits))</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 指定连接字符</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;连接后的字符串 &#34;</span>,<span class="built_in">table</span>.<span class="built_in">concat</span>(fruits,<span class="string">&#34;, &#34;</span>))</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 指定索引来连接 table</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;连接后的字符串 &#34;</span>,<span class="built_in">table</span>.<span class="built_in">concat</span>(fruits,<span class="string">&#34;, &#34;</span>, <span class="number">2</span>,<span class="number">3</span>))</span><br/></pre></td></tr></tbody></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line">连接后的字符串 bananaorangeapple</span><br/><span class="line">连接后的字符串 banana, orange, apple</span><br/><span class="line">连接后的字符串 orange, apple</span><br/></pre></td></tr></tbody></table></figure>
<ol>
<li><p>table.insert、table.remove</p>
<p> table.insert() 建议在数组形式的表使用，键值对形式的表直接键值对形式插入<br/> table.remove() 用于数组形式的表，键值对形式的表直接给键赋值nil</p>
</li>
</ol>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/></pre></td><td class="code"><pre><span class="line">fruits = {<span class="string">&#34;banana&#34;</span>,<span class="string">&#34;orange&#34;</span>,<span class="string">&#34;apple&#34;</span>}</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 在末尾插入</span></span><br/><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(fruits,<span class="string">&#34;mango&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;索引为 4 的元素为 &#34;</span>,fruits[<span class="number">4</span>])</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 在索引为 2 的键处插入</span></span><br/><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(fruits,<span class="number">2</span>,<span class="string">&#34;grapes&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;索引为 2 的元素为 &#34;</span>,fruits[<span class="number">2</span>])</span><br/><span class="line"></span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;最后一个元素为 &#34;</span>,fruits[<span class="number">5</span>])</span><br/><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(fruits)</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;移除后最后一个元素为 &#34;</span>,fruits[<span class="number">5</span>])</span><br/></pre></td></tr></tbody></table></figure>
<ol>
<li>table.sort</li>
</ol>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">fruits = {<span class="string">&#34;banana&#34;</span>,<span class="string">&#34;orange&#34;</span>,<span class="string">&#34;apple&#34;</span>,<span class="string">&#34;grapes&#34;</span>}</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;排序前&#34;</span>)</span><br/><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(fruits) <span class="keyword">do</span></span><br/><span class="line">  <span class="built_in">print</span>(k,v)</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(fruits)</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;排序后&#34;</span>)</span><br/><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(fruits) <span class="keyword">do</span></span><br/><span class="line">   <span class="built_in">print</span>(k,v)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/></pre></td><td class="code"><pre><span class="line">排序前</span><br/><span class="line"><span class="number">1</span>   banana</span><br/><span class="line"><span class="number">2</span>   orange</span><br/><span class="line"><span class="number">3</span>   apple</span><br/><span class="line"><span class="number">4</span>   grapes</span><br/><span class="line">排序后</span><br/><span class="line"><span class="number">1</span>   apple</span><br/><span class="line"><span class="number">2</span>   banana</span><br/><span class="line"><span class="number">3</span>   grapes</span><br/><span class="line"><span class="number">4</span>   orange</span><br/></pre></td></tr></tbody></table></figure>
<ol>
<li>Table中最大的正数key值</li>
</ol>
<p>table.maxn 在 Lua5.2 之后该方法已经不存在了，自定义table_maxn方法来实现。<br/>以下实例演示了如何获取 table 中的最大值：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">(t)</span></span></span><br/><span class="line">    <span class="keyword">local</span> mn = <span class="number">0</span></span><br/><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t) <span class="keyword">do</span></span><br/><span class="line">        <span class="keyword">if</span> mn &lt; k <span class="keyword">then</span></span><br/><span class="line">            mn = k</span><br/><span class="line">        <span class="keyword">end</span></span><br/><span class="line">    <span class="keyword">end</span></span><br/><span class="line">    <span class="keyword">return</span> mn</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line">tbl = {[<span class="number">1</span>] = <span class="string">&#34;a&#34;</span>, [<span class="number">2</span>] = <span class="string">&#34;b&#34;</span>, [<span class="number">3</span>] = <span class="string">&#34;c&#34;</span>, [<span class="number">26</span>] = <span class="string">&#34;z&#34;</span>}</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;tbl 长度 &#34;</span>, #tbl)</span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;tbl 最大值 &#34;</span>, table_maxn(tbl))</span><br/></pre></td></tr></tbody></table></figure>
<p>执行以上代码输出结果为：</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">tbl 长度    <span class="number">3</span></span><br/><span class="line">tbl 最大值  <span class="number">26</span></span><br/></pre></td></tr></tbody></table></figure>
<ol>
<li>table.getn</li>
</ol>
<p>获取数组形式表的元素个数，键值对表使用遍历</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/></pre></td><td class="code"><pre><span class="line">myTable = {}</span><br/><span class="line">myTable[<span class="number">1</span>] = <span class="string">&#34;1&#34;</span></span><br/><span class="line">myTable[<span class="number">2</span>] = <span class="string">&#34;2&#34;</span></span><br/><span class="line">myTable[<span class="number">3</span>] = <span class="string">&#34;3&#34;</span></span><br/><span class="line">myTable[<span class="string">&#34;r&#34;</span>] = <span class="string">&#34;Red&#34;</span></span><br/><span class="line">myTable[<span class="string">&#34;g&#34;</span>] = <span class="string">&#34;Green&#34;</span></span><br/><span class="line">myTable[<span class="string">&#34;b&#34;</span>] = <span class="string">&#34;Blue&#34;</span></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">getn</span>(myTable))</span><br/><span class="line"></span><br/><span class="line">length = <span class="number">0</span></span><br/><span class="line"><span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">pairs</span>(myTable) <span class="keyword">do</span></span><br/><span class="line">    length = length + <span class="number">1</span></span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"><span class="built_in">print</span>(length)</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 输出</span></span><br/><span class="line"><span class="comment">-- 3</span></span><br/><span class="line"><span class="comment">-- 6</span></span><br/></pre></td></tr></tbody></table></figure>