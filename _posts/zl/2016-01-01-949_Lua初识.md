---
layout: post
title: Lua初识 
tags: [lua文章]
categories: [topic]
---
<h2 id="Lua初识"><a href="#Lua初识" class="headerlink" title="Lua初识"></a>Lua初识</h2><h3 id="Lua-数据类型"><a href="#Lua-数据类型" class="headerlink" title="Lua 数据类型"></a>Lua 数据类型</h3><ul><li>8种基本类型:</li><li>nil :表示无效值(条件表达式代表false)</li><li>boolean:布尔 包含两个值:true和false</li><li>number: 表示双精度类型的实浮点数</li><li>string: 字符串有””或者’’表示</li><li>userdata: 任意存储中的C数据结构</li><li>function: Lua或C编写的函数</li><li>thread: 执行独立线路,执行协同程序</li><li>table: 关联数据(associative arrays),索引是数字或者字符串,table的创建通过”构造表达式”来完成,最简单构造表达式{}(创建一个空表)</li></ul><h4 id="nil"><a href="#nil" class="headerlink" title="nil"></a>nil</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">nil:空</span><br/><span class="line"> print(type(x)==&#34;nil&#34;) true</span><br/><span class="line"> print(typeI(x)==nil) false</span><br/><span class="line"> 注: type(X)==nil 结果为 false 的原因是因为 type(type(X))==string</span><br/></pre></td></tr></tbody></table></figure><h4 id="number"><a href="#number" class="headerlink" title="number"></a>number</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/></pre></td><td class="code"><pre><span class="line">number类型--双精度类型(默认类型修改luaconf.h文中定义)</span><br/><span class="line">例如:</span><br/><span class="line">print(type(2))</span><br/><span class="line">print(type(2.2))</span><br/><span class="line">print(type(0.2))</span><br/><span class="line">print(type(2e+1))</span><br/><span class="line">print(type(2.1231231465e-06))</span><br/></pre></td></tr></tbody></table></figure><h4 id="string"><a href="#string" class="headerlink" title="string"></a>string</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">用 [[]] 表示一块字符串</span><br/><span class="line">例如:</span><br/><span class="line">html = [[</span><br/><span class="line">    &lt;html&gt;</span><br/><span class="line">    &lt;head&gt;&lt;/head&gt;</span><br/><span class="line">    &lt;body&gt;</span><br/><span class="line">        &lt;a href=&#34;https://herb95.github.io/&#34;&gt;Graywolf 博客&lt;/a&gt;</span><br/><span class="line">    &lt;/body&gt;</span><br/><span class="line">    &lt;/html&gt;</span><br/><span class="line">]]</span><br/><span class="line">print(html)</span><br/></pre></td></tr></tbody></table></figure><h4 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/></pre></td><td class="code"><pre><span class="line">数字,字符串上进行运算</span><br/><span class="line">print(&#34;3&#34;+9)</span><br/><span class="line">print(&#34;3&#34;+&#34;9&#34;)</span><br/><span class="line">print(&#34;3+9&#34;)</span><br/><span class="line">print(&#34;-2e2&#34;*9)</span><br/><span class="line">print(&#34;e&#34;+2)</span><br/><span class="line">结果:</span><br/><span class="line">12</span><br/><span class="line">12</span><br/><span class="line">3+9</span><br/><span class="line">-1800</span><br/><span class="line">error...</span><br/></pre></td></tr></tbody></table></figure><p><strong>注:字符串连接使用是 ..</strong><br/><strong>注:用#来计算字符串的长度</strong></p><h4 id="运用"><a href="#运用" class="headerlink" title="# 运用"></a># 运用</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">len=&#34;herb95.github.io/&#34;</span><br/><span class="line">print(#len)</span><br/><span class="line">print(#&#34;herb95.github.io/&#34;)</span><br/><span class="line">结果:</span><br/><span class="line">17</span><br/><span class="line">17</span><br/></pre></td></tr></tbody></table></figure><h4 id="table"><a href="#table" class="headerlink" title="table"></a>table</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">tab1 ={}</span><br/><span class="line">-- 直接初始化</span><br/><span class="line">tab2 ={&#34;1&#34;,&#34;2&#34;,&#34;3&#34;,&#34;4&#34;}</span><br/><span class="line">for k,v in pairs(tab2) do</span><br/><span class="line">    print(k.. &#34;:&#34; .. v)</span><br/><span class="line">end</span><br/><span class="line">结果:</span><br/><span class="line">1:1</span><br/><span class="line">2:2</span><br/><span class="line">3:3</span><br/><span class="line">4:4</span><br/></pre></td></tr></tbody></table></figure><p><strong>注:lua表默认初始索引一般以1开始</strong><br/><strong>table不会固定长度大小,有新数据添加table长度会自动增长,没初始的table都是nil</strong></p><h4 id="function"><a href="#function" class="headerlink" title="function"></a>function</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">-- function 函数是被看做事&#34;第一类值(First-Class Value),可存变量&#34;:</span><br/><span class="line">例如:</span><br/><span class="line">function add(a,b)</span><br/><span class="line">   return a+b</span><br/><span class="line">end</span><br/><span class="line">print(add(10,20))</span><br/><span class="line">add2 = add</span><br/><span class="line">print(add(10,30))</span><br/><span class="line">结果:</span><br/><span class="line">30</span><br/><span class="line">40</span><br/></pre></td></tr></tbody></table></figure><p>function 可以做匿名函数(anonymous function)的方式参数传递:<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/></pre></td><td class="code"><pre><span class="line">function testFun(tab,fun)</span><br/><span class="line">    for k,v in pairs(tab) do</span><br/><span class="line">        print(fun(k,v))</span><br/><span class="line">    end</span><br/><span class="line">end</span><br/><span class="line"></span><br/><span class="line">tab1 = {k1= &#34;1&#34;,k2 = &#34;3&#34;};</span><br/><span class="line">testFun(tab1,</span><br/><span class="line">function(k,v)</span><br/><span class="line">    return k..&#34;=&#34;..v</span><br/><span class="line">end</span><br/><span class="line">)</span><br/><span class="line">结果:</span><br/><span class="line">k1=1</span><br/><span class="line">k2=3</span><br/></pre></td></tr></tbody></table></figure><p></p><h4 id="thread线程"><a href="#thread线程" class="headerlink" title="thread线程"></a>thread线程</h4><p>lua中最主要的线程是协同程序(coroutine),跟线程(thread)差不多,拥有自己独立的栈、 局部变量和指令指针，可与其他协同程序共享全局变量<br/>线程和协程的区别：</p><blockquote><ul><li>线程可以多个运行；</li><li>协程任意时刻只能运行一个，并且处于运行状态的协程只有被挂起(suspend)时才会暂停</li></ul></blockquote><h4 id="userdata-自定义类型"><a href="#userdata-自定义类型" class="headerlink" title="userdata (自定义类型)"></a>userdata (自定义类型)</h4><p>是一种用户自定义数据,表示一种有应用程序或C/C++语言库创建类型,将任意C/C++任意数据类型的数据(通常是struct和指针) 存到lua变量中调用</p>