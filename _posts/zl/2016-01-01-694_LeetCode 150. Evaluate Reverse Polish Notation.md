---
layout: post
title: LeetCode 150. Evaluate Reverse Polish Notation 
tags: [lua文章]
categories: [topic]
---
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Evaluate the value of an arithmetic expression in <a href="https://en.wikipedia.org/wiki/Reverse_Polish_notation" target="_blank" rel="external noopener noreferrer">Reverse Polish Notation</a>.</p>
<p>Valid operators are <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>. Each operand may be an integer or another expression.</p>
<p>Some examples:</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="string">&#34;2&#34;</span>, <span class="string">&#34;1&#34;</span>, <span class="string">&#34;+&#34;</span>, <span class="string">&#34;3&#34;</span>, <span class="string">&#34;*&#34;</span>] -&gt; ((<span class="number">2</span> + <span class="number">1</span>) * <span class="number">3</span>) -&gt; <span class="number">9</span></div><div class="line">[<span class="string">&#34;4&#34;</span>, <span class="string">&#34;13&#34;</span>, <span class="string">&#34;5&#34;</span>, <span class="string">&#34;/&#34;</span>, <span class="string">&#34;+&#34;</span>] -&gt; (<span class="number">4</span> + (<span class="number">13</span> / <span class="number">5</span>)) -&gt; <span class="number">6</span></div></pre></td></tr></tbody></table></figure>
<p> </p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>计算一个后缀表达式（逆波兰式），式中的操作数均为整数，运算符只含有加减乘除四种。</p>
<p>逆波兰式中的运算符每次向前找数个最临近的操作数作为其作用对象，因此只要将每一个数或操作符依次入栈，当入栈的是操作数时不做其他处理，当入栈的是操作符时，将操作符连同该操作符所需个数的操作数一同取出（出栈）来进行一次运算，将算得的结果再存回栈即可完成一次运算。</p>
<p>由于题目给定的总是合法的逆波兰式，所以最终栈中只有一个元素，即是算式的最终结果。</p>
<p>实现上要注意的点：</p>
<p>1.由于题目所给的操作符和操作数均为string形式（C++），运算需要将string转化为int，不要忽略负数的符号位‘-’在转化时的干扰。</p>
<p>2.将int转化为string可以利用C++的stringstream，代码可写为：</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> val = <span class="number">100</span>;</div><div class="line"><span class="built_in">stringstream</span> ss;</div><div class="line"><span class="built_in">string</span> str;</div><div class="line">ss&lt;&lt;val;</div><div class="line">ss&gt;&gt;str; </div></pre></td></tr></tbody></table></figure>
<p> </p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="params">(<span class="built_in">string</span> str)</span></span></div><div class="line">    {</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>, i = <span class="number">0</span>;</div><div class="line">        <span class="keyword">bool</span> neg_flag = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span>(str[<span class="number">0</span>] == <span class="string">&#39;-&#39;</span>)</div><div class="line">        {</div><div class="line">            neg_flag = <span class="literal">true</span>;</div><div class="line">            i++;</div><div class="line">        }</div><div class="line">        <span class="keyword">for</span>(; i &lt; (<span class="keyword">int</span>)str.length(); i++)</div><div class="line">        {</div><div class="line">            ret *= <span class="number">10</span>;</div><div class="line">            ret += str[i] - <span class="string">&#39;0&#39;</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(neg_flag) <span class="keyword">return</span> -ret;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">calculate</span><span class="params">(<span class="built_in">string</span> a, <span class="built_in">string</span> b, <span class="built_in">string</span> oper)</span></span></div><div class="line">    {</div><div class="line">        <span class="keyword">int</span> left = string2int(a);</div><div class="line">        <span class="keyword">int</span> right = string2int(b);</div><div class="line">        <span class="keyword">switch</span>(oper[<span class="number">0</span>])</div><div class="line">        {</div><div class="line">            <span class="keyword">case</span> <span class="string">&#39;+&#39;</span>: <span class="keyword">return</span> left + right;</div><div class="line">            <span class="keyword">case</span> <span class="string">&#39;-&#39;</span>: <span class="keyword">return</span> left - right;</div><div class="line">            <span class="keyword">case</span> <span class="string">&#39;*&#39;</span>: <span class="keyword">return</span> left * right;</div><div class="line">            <span class="keyword">case</span> <span class="string">&#39;/&#39;</span>: <span class="keyword">return</span> left / right;</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> INT_MIN;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">evalRPN</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; tokens)</span></span></div><div class="line">    {</div><div class="line">        <span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt; S;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;::iterator it = tokens.begin();</div><div class="line">        <span class="keyword">for</span>(; it != tokens.end(); it++)</div><div class="line">        {</div><div class="line">            S.push(*it);</div><div class="line">            <span class="keyword">if</span>(S.top().length() == <span class="number">1</span> &amp;&amp;</div><div class="line">               (S.top()[<span class="number">0</span>] == <span class="string">&#39;+&#39;</span> ||S.top()[<span class="number">0</span>] == <span class="string">&#39;-&#39;</span> || S.top()[<span class="number">0</span>] == <span class="string">&#39;*&#39;</span> || S.top()[<span class="number">0</span>] == <span class="string">&#39;/&#39;</span>))</div><div class="line">            {</div><div class="line">                <span class="built_in">string</span> oper = S.top();</div><div class="line">                S.pop();</div><div class="line">                <span class="built_in">string</span> b = S.top();</div><div class="line">                S.pop();</div><div class="line">                <span class="built_in">string</span> a = S.top();</div><div class="line">                S.pop();</div><div class="line">                <span class="keyword">int</span> val = calculate(a, b, oper);</div><div class="line"></div><div class="line">                <span class="built_in">stringstream</span> ss;</div><div class="line">                <span class="built_in">string</span> str;</div><div class="line">                ss&lt;&lt;val;</div><div class="line">                ss&gt;&gt;str;</div><div class="line">                S.push(str);</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> string2int(S.top());</div><div class="line">    }</div><div class="line">};</div></pre></td></tr></tbody></table></figure>