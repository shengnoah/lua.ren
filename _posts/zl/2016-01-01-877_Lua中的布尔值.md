---
layout: post
title: Lua中的布尔值 
tags: [lua文章]
categories: [topic]
---
<h2 id="Lua中的真值和假值"><a href="#Lua中的真值和假值" class="headerlink" title="Lua中的真值和假值"></a>Lua中的真值和假值</h2><p><strong>除了nil和false为假, 其它都为真.</strong> </p>
<p>这意味着包括0, 空字符串, 空表都为真.</p>
<h2 id="源码中关于布尔值的代码"><a href="#源码中关于布尔值的代码" class="headerlink" title="源码中关于布尔值的代码"></a>源码中关于布尔值的代码</h2><pre><code class="c">#define l_isfalse(o)    (ttisnil(o) || (ttisboolean(o) &amp;&amp; bvalue(o) == 0))
</code></pre>
<p>说明:</p>
<ul>
<li><code>ttisnil(o)</code> : 判断对象o是否为nil值</li>
<li><code>ttisboolean(o)</code> : 判断对象的tag是否为 <code>LUA_TBOOLEAN</code></li>
<li><code>bvalue(o)</code> : 判断对象的联合体 <code>value_</code> 中的变量<code>b</code>是否为0</li>
</ul>
<h2 id="布尔值的应用"><a href="#布尔值的应用" class="headerlink" title="布尔值的应用"></a>布尔值的应用</h2><h3 id="传参时的「nil」和「false」的�"><a href="#传参时的「nil」和「false」的�" class="headerlink" title="传参时的「nil」和「false」的�"></a>传参时的「nil」和「false」的�</h3><p>Lua中经常给参数设置默认值的代码是 <code>input = input or value</code>, 当input为空时, 我们赋予它默认值value. 但是这个并不适用于布尔值. </p>
<p>如果我们的参数类型为false时, 执行<code>input = input or value</code>之后它被改成默认值, 所以input被改成了true!<code></code></p>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><p>Lua中的逻辑运算符是 and, or, not, 其中逻辑运算规则下</p>
<pre><code>A and B -- 如果A为false，则返回A，否则返回B
A or B -- 如果A为true，则返回A，否则返回B
</code></pre><h3 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h3><p>Lua中并没有三元运算符, 但是利用运算 <code>ret = A and B or C</code> 可以实现其效果.</p>
<p>但是需要注意的是, <strong>如果B为false, 则ret永远为C</strong>, 达不到”当A为真时, ret为B; 否则为C”的效果, 因为<code>A and false</code> 永远为false,  <code>false or C</code>永远为C</p>
<p>式子<code>ret = A and true or false</code>可以用在判断A是否存在(即为nil)</p>