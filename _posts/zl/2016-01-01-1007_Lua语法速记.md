---
layout: post
title: Lua语法速记 
tags: [lua文章]
categories: [topic]
---
<h2 id="基础语法速记"><a href="#基础语法速记" class="headerlink" title="基础语法速记"></a>基础语法速记</h2><ul>
<li>单行注释 --</li>
<li>多行注释 —[[]]—</li>
<li>数据类型，nil、boolean、number、string、、table、function、userdata和thread</li>
<li>不等于，~=</li>
<li>逻辑运算符，and，or，not</li>
</ul>

<h2 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h2><h3 id="if-else-分支结构"><a href="#if-else-分支结构" class="headerlink" title="if else 分支结构"></a>if else 分支结构</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">score = <span class="number">60</span></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">if</span> (score &gt;= <span class="number">80</span>) <span class="keyword">then</span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;优秀&#34;</span>)</span><br/><span class="line"><span class="keyword">elseif</span> (score &gt;= <span class="number">70</span>) <span class="keyword">then</span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;良好&#34;</span>)</span><br/><span class="line"><span class="keyword">elseif</span> (score &gt;= <span class="number">60</span>) <span class="keyword">then</span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;及格&#34;</span>)</span><br/><span class="line"><span class="keyword">else</span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;不及格&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<h4 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h4><ol>
<li>if 后面都有一个 then</li>
<li>elseif 之间没有空格</li>
</ol>
<h2 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h2><h3 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i=<span class="number">0</span>, <span class="number">10</span>, <span class="number">1</span> <span class="keyword">do</span></span><br/><span class="line">4<span class="built_in">print</span>(i)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<h4 id="Tips-1"><a href="#Tips-1" class="headerlink" title="Tips"></a>Tips</h4><ol>
<li>用逗号(,)</li>
<li>条件判断，小于等于10</li>
<li>Lua 只有 break,没有 continue</li>
</ol>
<h3 id="While-循环"><a href="#While-循环" class="headerlink" title="While 循环"></a>While 循环</h3><p>当条件满足时，执行循环</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">temp = <span class="number">10</span></span><br/><span class="line"><span class="keyword">while</span> (temp &gt; <span class="number">0</span>) <span class="keyword">do</span></span><br/><span class="line">4<span class="built_in">print</span>(<span class="string">&#34;temp&#34;</span>..temp)</span><br/><span class="line">4temp = temp - <span class="number">1</span></span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<h3 id="repeat-循环"><a href="#repeat-循环" class="headerlink" title="repeat 循环"></a>repeat 循环</h3><p>执行循环，直到条件满足</p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">num = <span class="number">10</span></span><br/><span class="line"><span class="keyword">repeat</span></span><br/><span class="line">4<span class="built_in">print</span>(num)</span><br/><span class="line">4num = num <span class="number">-1</span></span><br/><span class="line"><span class="keyword">until</span>(num==<span class="number">0</span>)</span><br/></pre></td></tr></tbody></table></figure>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">myArray1 = {}</span><br/><span class="line">myArray2 = {<span class="string">&#34;a&#34;</span>, <span class="number">123</span>, <span class="literal">nil</span>, <span class="literal">true</span>}</span><br/></pre></td></tr></tbody></table></figure>
<h4 id="Tips-2"><a href="#Tips-2" class="headerlink" title="Tips"></a>Tips</h4><ol>
<li>长度不固定</li>
<li>数据类型不限制</li>
<li>下标从1开始</li>
</ol>
<p>获取长度<br/>table.getn(myArray2)</p>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">name = <span class="string">&#34;Zak&#34;</span></span><br/></pre></td></tr></tbody></table></figure>
<p>详见<a href="">lua-字符串操作</a></p>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">(parm)</span></span> </span><br/><span class="line">4<span class="built_in">print</span>(parm)</span><br/><span class="line">4<span class="keyword">return</span> parm <span class="comment">-- 返回值</span></span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<h4 id="Tips-3"><a href="#Tips-3" class="headerlink" title="Tips"></a>Tips</h4><ol>
<li>先声明后调用</li>
<li>函数可以作为函数参数</li>
</ol>
<h2 id="表-table"><a href="#表-table" class="headerlink" title="表 table"></a>表 table</h2><h3 id="表的创建"><a href="#表的创建" class="headerlink" title="表的创建"></a>表的创建</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 表名 = {}</span></span><br/><span class="line">myTable = {}</span><br/><span class="line">myTable = {<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&#34;a&#34;</span>, <span class="literal">true</span>}</span><br/></pre></td></tr></tbody></table></figure>
<h3 id="表的赋值"><a href="#表的赋值" class="headerlink" title="表的赋值"></a>表的赋值</h3><pre><code>两种方式：数组形式赋值，键值对形式赋值
</code></pre><ol>
<li>以数组的形式赋值（就是数组）</li>
</ol>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">myTable = {}</span><br/><span class="line">myTable[<span class="number">1</span>] = <span class="string">&#34;1&#34;</span></span><br/><span class="line">myTable[<span class="number">2</span>] = <span class="string">&#34;2&#34;</span></span><br/><span class="line">myTable[<span class="number">3</span>] = <span class="string">&#34;3&#34;</span></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">ipairs</span>(myTable) <span class="keyword">do</span></span><br/><span class="line">    <span class="built_in">print</span>(index, value)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<ul>
<li>下标从 1 开始</li>
<li>下标必须连续的</li>
</ul>
<ol>
<li>以键值对的形式赋值</li>
</ol>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">myTable = {}</span><br/><span class="line">myTable[<span class="string">&#34;r&#34;</span>] = <span class="string">&#34;Red&#34;</span></span><br/><span class="line">myTable[<span class="string">&#34;g&#34;</span>] = <span class="string">&#34;Green&#34;</span></span><br/><span class="line">myTable[<span class="string">&#34;b&#34;</span>] = <span class="string">&#34;Blue&#34;</span></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="built_in">pairs</span>(myTable) <span class="keyword">do</span></span><br/><span class="line">    <span class="built_in">print</span>(key, value)</span><br/><span class="line"><span class="keyword">end</span></span><br/></pre></td></tr></tbody></table></figure>
<ul>
<li>ipairs 用于遍历数组，pairs 用于遍历数组或表，数组是表的一种</li>
</ul>
<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><h3 id="模块定义"><a href="#模块定义" class="headerlink" title="模块定义"></a>模块定义</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MyMath.lua   -- 脚本的名称要和模块的名称一样</span></span><br/><span class="line">MyMath = {}     <span class="comment">-- 定义模块</span></span><br/><span class="line"></span><br/><span class="line">MyMath.PI = <span class="number">3.1415</span>     <span class="comment">-- 定义常量</span></span><br/><span class="line"></span><br/><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyMath.Add</span><span class="params">(first, second)</span></span>     <span class="comment">-- 定义公开方法</span></span><br/><span class="line">    <span class="keyword">return</span> first+second</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">fun</span><span class="params">()</span></span>            <span class="comment">-- 定义私有方法</span></span><br/><span class="line">    <span class="built_in">print</span>(<span class="string">&#34;这是私有方法&#34;</span>)</span><br/><span class="line"><span class="keyword">end</span></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">return</span> MyMath   <span class="comment">-- 结束模块</span></span><br/></pre></td></tr></tbody></table></figure>
<h3 id="模块使用"><a href="#模块使用" class="headerlink" title="模块使用"></a>模块使用</h3><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#34;MyMath&#34;</span>)   <span class="comment">-- 加载模块</span></span><br/><span class="line"><span class="built_in">print</span>(MyMath.Add(MyMath.PI, <span class="number">10</span>))</span><br/><span class="line"></span><br/><span class="line">myMath = <span class="built_in">require</span>(<span class="string">&#34;MyMath&#34;</span>)  <span class="comment">-- 加载模块，别名使用</span></span><br/><span class="line"><span class="built_in">print</span>(myMath.Add(<span class="number">1</span>, <span class="number">2</span>))</span><br/></pre></td></tr></tbody></table></figure>
<h2 id="元表"><a href="#元表" class="headerlink" title="元表"></a>元表</h2><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">tableA = {Province = <span class="string">&#34;GuangDong&#34;</span>, City = <span class="string">&#34;Guangzhou&#34;</span>}	<span class="comment">-- 表A</span></span><br/><span class="line">tableB = {Block = <span class="string">&#34;TianHe&#34;</span>, Road = <span class="string">&#34;JiShanLu&#34;</span>}			<span class="comment">-- 表B</span></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">setmetatable</span>(tableA, tableB)	<span class="comment">-- 设置表B为表A的元表</span></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">getmetatable</span>(tableA)	<span class="comment">-- 获取表的元表，返回元表，nil表示没有包含元表</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">getmetatable</span>(tableA))</span><br/><span class="line"></span><br/><span class="line">tableB.<span class="built_in">__index</span> = tableB	<span class="comment">-- 设置元表的索引</span></span><br/><span class="line"></span><br/><span class="line"><span class="built_in">print</span>(tableA.Province, tableA.City, tableA.Block, tableA.Road)</span><br/></pre></td></tr></tbody></table></figure>