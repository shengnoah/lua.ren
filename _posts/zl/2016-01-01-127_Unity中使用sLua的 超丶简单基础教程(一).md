---
layout: post
title: Unity中使用sLua的 超丶简单基础教程(一) 
tags: [lua文章]
categories: [topic]
---
<p><img src="https://Lafree317.github.io/../../images/Slua-1.png" alt=""/></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>网上Unity使用lua的文章本来就少..slua又是个偏小众的lua库..文章更少..</p>
<p>已有的文章又有点坑…比如方法名关键字写错啦..真的是坑多= =</p>
<p>所以总结一片超简单教学= =</p>
<p>这篇文章面向刚开始学习lua 想在unity项目中使用sLua库的同学..</p>

<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="导入sLua"><a href="#导入sLua" class="headerlink" title="导入sLua"></a>导入sLua</h4><ul>
<li>1.直接下载最新版:<a href="https://github.com/pangweiwei/slua/releases/" target="_blank" rel="noopener noreferrer">sLua库下载地址</a></li>
<li>2.然后将解压后的Assets文件复制到你项目的Assets目录下,不要放到其他地方.</li>
<li>3.等待Unity编译完成,会出现SLua菜单如下图.然后选择Slua-All-Make命令 手动生成针对当前版本的Unity接口文件</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/1/20/161138abbd015ee9?w=355&amp;h=136&amp;f=png&amp;s=14264" alt="图1-1"/></p>
<p>做到这步你已经可以在Assets/Slua/example中查看sLua的官方例子了.每一个Scenes都展示了一种使用方法.</p>
<h4 id="自己使用Lua脚本"><a href="#自己使用Lua脚本" class="headerlink" title="自己使用Lua脚本"></a>自己使用Lua脚本</h4><p>创建一个新的Scene然后创建一个CreateEmpty创建一个C#文件挂载上去.然后在C#文件中写如下代码:<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/></pre></td><td class="code"><pre><span class="line">using UnityEngine;</span><br/><span class="line">using SLua;</span><br/><span class="line"></span><br/><span class="line">public class Test : MonoBehaviour{</span><br/><span class="line"></span><br/><span class="line">    private static LuaState ls_state;</span><br/><span class="line"></span><br/><span class="line">    void Start()</span><br/><span class="line">    {</span><br/><span class="line">        ls_state = new LuaState();</span><br/><span class="line">        ls_state.doString(&#34;print(&#34;Hello Lua!&#34;)&#34;);</span><br/><span class="line"></span><br/><span class="line">    }</span><br/><span class="line"></span><br/><span class="line">}</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>成功后的样子是这样:</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/1/20/161139671a4de279?w=425&amp;h=944&amp;f=png&amp;s=58039" alt=""/></p>
<p>注意有些教程中LuaState在声明成属性时就初始化了,但是会报错,一定要在Awake方法或Start或需要用到的时候再进行初始化…</p>
<h4 id="读取lua文件"><a href="#读取lua文件" class="headerlink" title="读取lua文件"></a>读取lua文件</h4><p>C#代码<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/></pre></td><td class="code"><pre><span class="line">using UnityEngine;</span><br/><span class="line">using System.Collections;</span><br/><span class="line">using SLua;</span><br/><span class="line">using System.IO;</span><br/><span class="line"></span><br/><span class="line">public class OpenLuaFile : MonoBehaviour{</span><br/><span class="line"></span><br/><span class="line">    public LuaState state;// sLua脚本代理</span><br/><span class="line"></span><br/><span class="line">    void Start()</span><br/><span class="line">    {</span><br/><span class="line"></span><br/><span class="line">        state = new LuaState();</span><br/><span class="line"></span><br/><span class="line">        state.loaderDelegate = ((string fn) =&gt;</span><br/><span class="line">        {</span><br/><span class="line">            string file_Path = Directory.GetCurrentDirectory() + &#34;/Assets/Script/Lua/&#34; + fn;</span><br/><span class="line">            Debug.Log(file_Path);</span><br/><span class="line">            return File.ReadAllBytes(file_Path);</span><br/><span class="line">        });</span><br/><span class="line"></span><br/><span class="line">        //执行脚本</span><br/><span class="line">        state.doFile(&#34;HelloLua.lua&#34;);</span><br/><span class="line">    }</span><br/><span class="line">}</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>在上面设定的路径中创建lua文件</p>
<p>代码:<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">print(&#34;你好 我是文件里的Lua!&#34;)</span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>“/Assets/Script/Lua/“为放置ua文件的目录,这个根据自己需求随意改变.</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/1/20/16113ac0db3b6dd5?w=605&amp;h=476&amp;f=png&amp;s=56768" alt=""/></p>
<p><img src="https://user-gold-cdn.xitu.io/2018/1/20/16113ac510abdc81?w=541&amp;h=1072&amp;f=png&amp;s=97504" alt=""/></p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>本篇教程很基础,如果有精力会将之后学习到的知识都整理成博客分享给大家~</p>