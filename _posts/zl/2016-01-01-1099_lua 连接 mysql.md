---
layout: post
title: lua 连接 mysql 
tags: [lua文章]
categories: [topic]
---
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">&#34;luasql.mysql&#34;</span></span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line">env = luasql.mysql()</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 连接数据库</span></span><br/><span class="line">conn = env:connect(<span class="string">&#34;数据库名&#34;</span>, <span class="string">&#34;用户名&#34;</span>, <span class="string">&#34;密码&#34;</span>, <span class="string">&#34;IP地址&#34;</span>, 端口)</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 设置数据库的编码格式</span></span><br/><span class="line">conn:<span class="built_in">execute</span><span class="string">&#34;SET NAMES UTF8&#34;</span></span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 执行数据库操作</span></span><br/><span class="line">cur = conn:<span class="built_in">execute</span>(<span class="string">&#34;sql语句&#34;</span>)</span><br/><span class="line">row = cur:fetch({},<span class="string">&#34;a&#34;</span>)</span><br/><span class="line"></span><br/><span class="line"><span class="comment">-- 关闭数据库连接</span></span><br/><span class="line">conn:<span class="built_in">close</span>()</span><br/><span class="line"><span class="comment">-- 关闭数据库环境</span></span><br/><span class="line">env:<span class="built_in">close</span>()</span><br/></pre></td></tr></tbody></table></figure>
<p><strong>注</strong></p>
<p><code>Lua &gt;= 5.2</code></p>
<figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">mysql = <span class="built_in">require</span> <span class="string">&#34;luasql.mysql&#34;</span></span><br/></pre></td></tr></tbody></table></figure>