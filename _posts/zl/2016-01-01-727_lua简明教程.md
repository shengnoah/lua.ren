---
layout: post
title: lua简明教程 
tags: [lua文章]
categories: [topic]
---
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>lua是一种轻量小巧的脚本语言。</p>
<h3 id="lua特性"><a href="#lua特性" class="headerlink" title="lua特性"></a>lua特性</h3><p>1.轻量级，编译后不过200K<br/>2.可扩展性<br/>3.自动内存管理<br/>4.支持面向过程编程和函数式编程<br/>……</p>

<h3 id="lua应用场景"><a href="#lua应用场景" class="headerlink" title="lua应用场景"></a>lua应用场景</h3><p>1.游戏开发<br/>2.独立应用脚本<br/>3.web应用脚本<br/>4.扩展和数据库插件<br/>5.安全系统</p>
<h2 id="安装使用"><a href="#安装使用" class="headerlink" title="安装使用"></a>安装使用</h2><h3 id="安装问题"><a href="#安装问题" class="headerlink" title="安装问题"></a>安装问题</h3><p>1.编译lua时，提示<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lua.c:80:31: fatal error: readline/readline.h: No such file or directory</div></pre></td></tr></tbody></table></figure><p></p>
<p>linux环境缺少readline库。<br/>到ftp://ftp.gnu.org/gnu/readline/  下载并进行安装</p>
<p>2.安装完readline后提示<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">/usr/local/lib/libreadline.so: undefined reference to `tputs&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `tgoto&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `tgetflag&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `UP&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `tgetent&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `tgetnum&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `PC&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `tgetstr&#39;</div><div class="line">/usr/local/lib/libreadline.so: undefined reference to `BC&#39;</div></pre></td></tr></tbody></table></figure><p></p>
<p>需要安装Ncurses</p>
<p>3.编译Ncurses提示 error: expected ‘)’ before ‘int’</p>
<p>导入环境变量,在进行配置编译,安装,命令如下<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">export CPPFLAGS=&#34;-P&#34;</div><div class="line">./configure</div><div class="line">make</div><div class="line">make install</div><div class="line">Ncurses</div></pre></td></tr></tbody></table></figure><p></p>
<p>参考:<br/><a href="https://stackoverflow.com/questions/37475222/ncurses-6-0-compilation-error-error-expected-before-int" target="_blank" rel="external noopener noreferrer">https://stackoverflow.com/questions/37475222/ncurses-6-0-compilation-error-error-expected-before-int</a></p>
<p>总结:安装成功安装lua的前提是linux上有readline和ncurses库.</p>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>和Python类似，它也可以交互式编程，在命令行输入lua后即可进入：<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;<span class="built_in">print</span>(<span class="string">&#34;Hello World&#34;</span>)</div><div class="line">Hello World</div><div class="line">&gt;</div></pre></td></tr></tbody></table></figure><p></p>
<p>当然也可以将脚本内容写在文件，例如，将上面的内容写在hello.lua：<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#!/usr/<span class="keyword">local</span>/bin/lua</div><div class="line"><span class="built_in">print</span>(<span class="string">&#34;Hello World&#34;</span>)</div></pre></td></tr></tbody></table></figure><p></p>
<p>其中第一行指定了lua解释器路径，执行：<br/></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="bash"> chmod +x hello.lua  </span></div><div class="line"><span class="bash"> ./hello.lua</span></div><div class="line">Hello World</div></pre></td></tr></tbody></table></figure><p></p>
<p>这里注意，如果你没有加第一行，shell就不知道用哪个解释器去解释运行，当然你也可以通过下面的方式运行：<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ lua hello.lua</div></pre></td></tr></tbody></table></figure><p></p>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>同样地，它至少有两种注释，单行注释使用—：<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-- 这里是单行注释</div><div class="line">print(&#34;hello&#34;)</div></pre></td></tr></tbody></table></figure><p></p>
<p>多行注释：<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">--[[</div><div class="line">多行注释</div><div class="line">多行注释</div><div class="line">--]]</div><div class="line">print(&#34;yanbinghu.com&#34;)</div></pre></td></tr></tbody></table></figure><p></p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ul>
<li>nil—表示无效值</li>
<li>boolean false和true,lua将nil看成是”假”</li>
<li>number 双精度类型的实浮点数</li>
<li>string 字符串</li>
<li>function 由c或lua编写的函数</li>
<li>userdata 表示任意存储在变量中的c数据结构</li>
<li>thread 表示执行的独立线路,用于执行协同程序</li>
<li>table lua中的表,类似于关联数组</li>
</ul>
<h4 id="判断类型"><a href="#判断类型" class="headerlink" title="判断类型"></a>判断类型</h4><p>可以通过type函数来判断数据类型<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">print(type(“hello”) ) --string</div><div class="line">print(type(type)) --function</div></pre></td></tr></tbody></table></figure><p></p>
<h4 id="字符串算数操作"><a href="#字符串算数操作" class="headerlink" title="字符串算数操作"></a>字符串算数操作</h4><p>在对一个数字字符串上进行算术操作时，Lua 会尝试将这个数字字符串转成一个数字:<br/>例如:<br/></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;print(“2” + “6”)</div><div class="line">8</div></pre></td></tr></tbody></table></figure><p></p>
<ul>
<li>字符串连接 ..</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;print(“a”..”b”)</div><div class="line">ab</div></pre></td></tr></tbody></table></figure>
<ul>
<li>计算字符串长度 #</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;print(#“a”)</div><div class="line">1</div></pre></td></tr></tbody></table></figure>
<h4 id="table"><a href="#table" class="headerlink" title="table"></a>table</h4><p>Lua 里表的默认初始索引一般以 1 开始</p>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><ul>
<li><p>默认情况下,变量总认为是全局的.<br/>全局变量不需要声明,访问未初始化的全局变量不会报错,得到的结果是 nil</p>
</li>
<li><p>想删除一个全局变量,只需要将变量赋值为nil<br/>当且仅当该变量不为nil时,变量存在</p>
</li>
<li><p>a =1 —&gt;全局变量</p>
</li>
<li><p>local b =2 —&gt;局部变量</p>
</li>
<li><p>Lua可以对多个变量同时赋值，变量列表和值列表的各个元素用逗号分开，赋值语句右边的值会依次赋给左边的变量。</p>
</li>
</ul>
<h2 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h2>