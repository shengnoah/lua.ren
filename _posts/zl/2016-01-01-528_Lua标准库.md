---
layout: post
title: Lua标准库 
tags: [lua文章]
categories: [topic]
---
<h3 id="string库概念"><a href="#string库概念" class="headerlink" title="string库概念"></a>string库概念</h3><p>lua解释器对字符串支持有限，一个程序可以创建字符并连接字符串，但是不能截取子串，检查字符串的大小，内容等，操作字符串的功能基本来自string库</p>
<p>lua5.1中字符串库的所有函数如下</p>
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">示例</th>
<th style="text-align:center">结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">len</td>
<td style="text-align:center">计算字符串长度</td>
<td style="text-align:center">string.len(“abcd”)</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">rep</td>
<td style="text-align:center">返回字符串s的n个拷贝</td>
<td style="text-align:center">string.rep(“abcd”,2)</td>
<td style="text-align:center">abcdabcd</td>
</tr>
<tr>
<td style="text-align:center">lower</td>
<td style="text-align:center">返回字符串全部字母大写</td>
<td style="text-align:center">string.lower(“AbcD”)</td>
<td style="text-align:center">abcd</td>
</tr>
<tr>
<td style="text-align:center">upper</td>
<td style="text-align:center">返回字符串全部字母小写</td>
<td style="text-align:center">string.upper(“AbcD”)</td>
<td style="text-align:center">ABCD</td>
</tr>
<tr>
<td style="text-align:center">format</td>
<td style="text-align:center">返回一个类似printf的格式化字符串</td>
<td style="text-align:center">string.format(“the value is:%d”,4)</td>
<td style="text-align:center">the value is:4</td>
</tr>
<tr>
<td style="text-align:center">sub</td>
<td style="text-align:center">返回i到n的字符串</td>
<td style="text-align:center">string.sub(“abcd”,2)</td>
<td style="text-align:center">bcd</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.sub(“abcd”,-2)</td>
<td style="text-align:center">cd</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.sub(“abcd”,2,-2)</td>
<td style="text-align:center">bc</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.sub(“abcd”,2,3)</td>
<td style="text-align:center">bc</td>
</tr>
<tr>
<td style="text-align:center">find</td>
<td style="text-align:center">在字符串中查找</td>
<td style="text-align:center">string.find(“cdcdcdcd”,”ab”)</td>
<td style="text-align:center">nil</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.find(“cdcdcdcd”,”cd”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.find(“cdcdcdcd”,”cd”,7)</td>
<td style="text-align:center">7 8</td>
</tr>
<tr>
<td style="text-align:center">gsub</td>
<td style="text-align:center">在字符串中替换</td>
<td style="text-align:center">string.gsub(“abcdabcd”,”a”,”z”);</td>
<td style="text-align:center">zbcdzbcd 2</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.gsub(“aaaa”,”a”,”z”,3);</td>
<td style="text-align:center">zzza 3</td>
</tr>
<tr>
<td style="text-align:center">byte</td>
<td style="text-align:center">返回字符的整数形式</td>
<td style="text-align:center">string.byte(“ABCD”,4)</td>
<td style="text-align:center">68</td>
</tr>
<tr>
<td style="text-align:center">char</td>
<td style="text-align:center">将整型数字转成字符并连接</td>
<td style="text-align:center">string.char(97,98,99,100)</td>
<td style="text-align:center">abcd</td>
</tr>
</tbody>
</table>
<p>String库中还可以结合基本的模式串进行应用：</p>
<p>【基本模式串】可以匹配一个特定字符集合内任何字符的模式项</p>
<table>
<thead>
<tr>
<th style="text-align:center">字符类</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">示例</th>
<th style="text-align:center">结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">.</td>
<td style="text-align:center">任意字符</td>
<td style="text-align:center">string.find(“”,”.”)</td>
<td style="text-align:center">nil</td>
</tr>
<tr>
<td style="text-align:center">%s</td>
<td style="text-align:center">空白符</td>
<td style="text-align:center">string.find(“ab cd”,”%s%s”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%S</td>
<td style="text-align:center">非空白符</td>
<td style="text-align:center">string.find(“ab cd”,”%S%S”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%p</td>
<td style="text-align:center">标点字符</td>
<td style="text-align:center">string.find(“ab,.cd”,”%p%p”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%P</td>
<td style="text-align:center">非标点字符</td>
<td style="text-align:center">string.find(“ab,.cd”,”%P%P”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%c</td>
<td style="text-align:center">控制字符</td>
<td style="text-align:center">string.find(“abcdtn”,”%c%c”)</td>
<td style="text-align:center">5 6</td>
</tr>
<tr>
<td style="text-align:center">%C</td>
<td style="text-align:center">非控制字符</td>
<td style="text-align:center">string.find(“tnabcd”,”%C%C”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%d</td>
<td style="text-align:center">数字</td>
<td style="text-align:center">string.find(“abcd12”,”%d%d”)</td>
<td style="text-align:center">5 6</td>
</tr>
<tr>
<td style="text-align:center">%D</td>
<td style="text-align:center">非数字</td>
<td style="text-align:center">string.find(“12abcd”,”%D%D”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%x</td>
<td style="text-align:center">十六进制数字</td>
<td style="text-align:center">string.find(“efgh”,”%x%x”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%X</td>
<td style="text-align:center">非十六进制数字</td>
<td style="text-align:center">string.find(“efgh”,”%X%X”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%a</td>
<td style="text-align:center">字母</td>
<td style="text-align:center">string.find(“AB12”,”%a%a”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%A</td>
<td style="text-align:center">非字母</td>
<td style="text-align:center">string.find(“AB12”,”%A%A”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%l</td>
<td style="text-align:center">小写字母</td>
<td style="text-align:center">string.find(“ABab”,”%l%l”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%L</td>
<td style="text-align:center">大写字母</td>
<td style="text-align:center">string.find(“ABab”,”%L%L”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%u</td>
<td style="text-align:center">大写字母</td>
<td style="text-align:center">string.find(“ABab”,”%u%u”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%U</td>
<td style="text-align:center">非大写字母</td>
<td style="text-align:center">string.find(“ABab”,”%U%U”)</td>
<td style="text-align:center">3 4</td>
</tr>
<tr>
<td style="text-align:center">%w</td>
<td style="text-align:center">字母和数字</td>
<td style="text-align:center">string.find(“a1()”,”%w%w”)</td>
<td style="text-align:center">1 2</td>
</tr>
<tr>
<td style="text-align:center">%W</td>
<td style="text-align:center">非字母和数字</td>
<td style="text-align:center">string.find(“a1()”,”%W%W”)</td>
<td style="text-align:center">3 4</td>
</tr>
</tbody>
</table>
<p>【转义字符%】</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">%</td>
<td style="text-align:center">转义字符</td>
<td style="text-align:center">string.find(“abc%..”,”%%”)</td>
<td style="text-align:center">4 4</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">string.find(“abc..d”,”%.%.”)</td>
<td style="text-align:center">4 5</td>
</tr>
</tbody>
</table>
<p>LUA中【模式修饰符】</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">匹配前一字符1次或多次</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">匹配前一字符0次或多次</td>
</tr>
<tr>
<td style="text-align:center">-</td>
<td style="text-align:center">匹配前一字符0次或多次</td>
</tr>
<tr>
<td style="text-align:center">？</td>
<td style="text-align:center">匹配前一字符0次或1次</td>
</tr>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">匹配目标串的开始部分</td>
</tr>
<tr>
<td style="text-align:center">$</td>
<td style="text-align:center">匹配目标串的结尾部分</td>
</tr>
</tbody>
</table>
<h3 id="string-len"><a href="#string-len" class="headerlink" title="string.len"></a>string.len</h3><p>string.len(s)返回字符串s的长度<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> sString = <span class="string">&#34;321dlkoinmlda&#34;</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="string">&#34;sString字符串的长度为：&#34;</span>..<span class="built_in">string</span>.<span class="built_in">len</span>(sString))     </span><br/></pre></td></tr></tbody></table></figure><p></p>
<h3 id="string-format"><a href="#string-format" class="headerlink" title="string.format"></a>string.format</h3><p>string.format(s,i)和C语言的printf几乎一模一样，十进制d 十六进制x 八进制o 浮点数f<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">pi</span> = <span class="number">3.014159625</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&#34;pi = %.4f&#34;</span>,<span class="built_in">pi</span>))     <span class="comment">--pi = 3.0142</span></span><br/><span class="line">d=<span class="number">5</span>;m=<span class="number">11</span>;y=<span class="number">1990</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&#34;%02d/%02d/%04d&#34;</span>),d,m,y)     <span class="comment">-- 05/11/1990</span></span><br/><span class="line">tag,title = <span class="string">&#34;hi&#34;</span>,<span class="string">&#34;a title&#34;</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&#34;&lt;%s&gt;%s&lt;%s&gt;&#34;</span>),tag,title,tag)     <span class="comment">--&lt;hi&gt;a title&lt;hi&gt;</span></span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>结合模式串达到最优使用<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> s = <span class="string">&#34;hello theee %d world~~~ %s&#34;</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(s,<span class="number">100</span>,<span class="string">&#34;!!!!&#34;</span>))     <span class="comment">-- hello theee 100 world~~~ !!!!</span></span><br/></pre></td></tr></tbody></table></figure><p></p>
<h3 id="string-find"><a href="#string-find" class="headerlink" title="string.find"></a>string.find</h3><p>string.find(s.i)查找字符串s中i字符串的对应的位置，返回的是起始和结束索引值<br/>s:目标串<br/>i:搜索匹配的字符串<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#34;hello world&#34;</span></span><br/><span class="line">i,j = <span class="built_in">string</span>.<span class="built_in">find</span>(s,<span class="string">&#34;hello&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(i,j)     <span class="comment">-- 1 5</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">sub</span>(s,i,j))     <span class="comment">-- hello(把s字符串从i到j出截取出来)</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">find</span>(s,<span class="string">&#34;world&#34;</span>))     <span class="comment">-- 7 11</span></span><br/><span class="line">i,j = <span class="built_in">string</span>.<span class="built_in">find</span>(s,<span class="string">&#34;l&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(i,j)     <span class="comment">--3 3</span></span><br/><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">find</span>(s,<span class="string">&#34;lll&#34;</span>))     <span class="comment">-- nil</span></span><br/></pre></td></tr></tbody></table></figure><p></p>
<h3 id="string-gsub"><a href="#string-gsub" class="headerlink" title="string.gsub"></a>string.gsub</h3><p>string.gsub(s,i,j)<br/>s:目标字符（要被操作的字符串）<br/>i:模式串（即将被替换掉的字符串）<br/>j:替换串（新的，要替换i的字符串）<br/>只有一个返回值，就是被替换完成后的最终字符串<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="string">&#34;Lua is cute&#34;</span>,<span class="string">&#34;cute&#34;</span>,<span class="string">&#34;greet&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(s)     <span class="comment">-- Lua is great</span></span><br/><span class="line">s = <span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="string">&#34;all lii&#34;</span>,<span class="string">&#34;l&#34;</span>,<span class="string">&#34;x&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(s)     <span class="comment">-- axx xii</span></span><br/><span class="line">s = stirng.<span class="built_in">gsub</span>(<span class="string">&#34;Lua is greet&#34;</span>,<span class="string">&#34;perl&#34;</span>,<span class="string">&#34;tcl&#34;</span>)</span><br/><span class="line"><span class="built_in">print</span>(s)     <span class="comment">-- Lua is greet</span></span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>可以匹配一个特定字符集合内任何字符的模式项<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(stirng.<span class="built_in">gsub</span>(<span class="string">&#34;hello,up-down!&#34;</span>,<span class="string">&#34;%A&#34;</span>,<span class="string">&#34;.&#34;</span>))     <span class="comment">-- hello.up.down.</span></span><br/></pre></td></tr></tbody></table></figure><p></p>