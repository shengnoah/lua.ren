---
layout: post
title: Lua 学习 chapter17  
tags: [lua文章]
categories: [topic]
---


                
                

				<h3 id="目录">目录</h3>
<ol>
  <li>require函数</li>
  <li>模块</li>
</ol>



<h2 id="require函数">require函数</h2>
<p>ruquire函数可以加载任意模块，然后创建和返回一个表.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kd">local</span> <span class="n">mod</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">"mod"</span>
<span class="n">mod</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>

<span class="kd">local</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">"mod"</span>
<span class="kd">local</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">foo</span>
<span class="n">f1</span><span class="p">()</span>

<span class="kd">local</span> <span class="n">f2</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">"mod"</span><span class="p">.</span><span class="n">foo</span>
<span class="n">f2</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>require 函数在表package.loaded中检查模块是否已经被加载过。如果加载过就返回相应的值，这就避免的重复的加载。没有加载，就会通过loadfile来对其进行加载。如果没有lua文档，就回去加载c标准库，使用底层函数package.loadlib进行加载。</p>

<p>如果加载函数有返回值，那么函数require会返回合格值，将其保存在packag.loaded中，如果没有返回值，且package.loaded[@rep{moduname}]为空，函数require就假设该模块的返回值是true。如果不存在这种，补偿会造成重复加载。</p>

<p>要强制加载同一模块两次，可以先将模块从package.loaded中删除：package.loaded.modname = nil.</p>

<h2 id="模块">模块</h2>
<p>在lua中，简单的使用模块的方式就是使用表将所有属性放到这个表中（可以封装成类），然后最后返回这个表。
如果不想返回的话，可以以选择给package.loaded[M] = M。赋值的方法。</p>


                
                
                <hr style="visibility: hidden;">