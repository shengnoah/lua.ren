---
layout: post
title: Lua学习笔记(二) 
tags: [lua文章]
categories: [topic]
---
<ul>
<li><a href="#变量">变量</a></li>
<li><a href="#赋值语句">赋值语句</a><ul>
<li><a href="#多变量赋值">多变量赋值</a></li>
</ul>
</li>
<li><a href="#索引">索引</a></li>
<li><a href="#循环">循环</a><ul>
<li><a href="#控制语句">控制语句</a></li>
</ul>
</li>
<li><a href="#流程控制">流程控制</a></li>
<li><a href="#函数">函数</a><ul>
<li><a href="#可变参数">可变参数</a></li>
</ul>
</li>
<li><a href="#运算符">运算符</a><ul>
<li><a href="#算术运算符">算术运算符</a></li>
<li><a href="#关系运算符">关系运算符</a></li>
<li><a href="#逻辑运算符">逻辑运算符</a></li>
<li><a href="#其它运算符">其它运算符</a></li>
<li><a href="#优先级">优先级</a></li>
</ul>
</li>
<li><a href="#字符串">字符串</a><ul>
<li><a href="#转义字符">转义字符</a></li>
<li><a href="#字符串操作">字符串操作</a></li>
<li><a href="#字符串格式化">字符串格式化</a></li>
<li><a href="#匹配模式">匹配模式</a><ul>
<li><a href="#模式">模式</a></li>
<li><a href="#捕获">捕获</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#数组">数组</a></li>
<li><a href="#迭代器">迭代器</a><ul>
<li><a href="#泛型for迭代器">泛型for迭代器</a></li>
<li><a href="#无状态迭代器">无状态迭代器</a></li>
<li><a href="#多状态迭代器">多状态迭代器</a></li>
</ul>
</li>
<li><a href="#table">table</a><ul>
<li><a href="#操作方法">操作方法</a></li>
</ul>
</li>
</ul>

<h2><span id="变量">变量</span></h2><p>使用前必须<strong>申明</strong>，即创建该变量。</p>
<p>包括：<strong>全局变量，局部变量，表中的域。</strong></p>
<p>前文中提到过，Lua中所有的变量默认都是全局变量，有一种情况是例外的，那就是用local显示声明为局部变量的。</p>
<p>试尝试：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">a=1;</span><br/><span class="line">local b = 2;</span><br/><span class="line">function test()</span><br/><span class="line">    c=3;</span><br/><span class="line">    local d=4;</span><br/><span class="line">end</span><br/><span class="line">test()</span><br/><span class="line">print(&#34;a&#34;..a)</span><br/><span class="line">print(&#34;b&#34;..b)</span><br/><span class="line">print(&#34;c&#34;..c)</span><br/><span class="line">print(d)</span><br/></pre></td></tr></tbody></table></figure>
<p><img src="https://thbelief.github.io//2019/04/20/Lua学习笔记-二/local.jpg" alt=""/></p>
<p>这里经过试验可以轻易的得知，local定义的变量的使用范围就是在当前的代码块儿之内的。一旦超出的话就直接归nil！</p>
<p>这里使用到了Lua中的一些语法，例如function与end，这里就不一一的详细描述了，后面会讲到。</p>
<h2><span id="赋值语句">赋值语句</span></h2><h3><span id="多变量赋值">多变量赋值</span></h3><p>在Lua中，多个变量可以一同赋值。（两边的数量相同时）</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line">a,b=&#34;hello&#34;,&#34;world&#34;</span><br/><span class="line">print(a)</span><br/><span class="line">print(b)</span><br/></pre></td></tr></tbody></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">hello</span><br/><span class="line">world</span><br/></pre></td></tr></tbody></table></figure>
<p><strong>当变量的个数不等于赋值个数的时候？</strong></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">a. 变量个数 &gt; 值的个数             按变量个数补足nil</span><br/><span class="line">b. 变量个数 &lt; 值的个数             多余的值会被忽略</span><br/></pre></td></tr></tbody></table></figure>
<p>注意，当函数返回多个值的时候，可以直接使用多变量赋值：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line">a,b=fun()</span><br/></pre></td></tr></tbody></table></figure>
<p>这里的话返回的多个值会直接赋值给前面的变量。</p>
<h2><span id="索引">索引</span></h2><p>对table表的使用索引主要就是包括了两种：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">site={}</span><br/><span class="line">site[&#34;key&#34;]=&#34;thbelief&#34;</span><br/><span class="line">--第一种方法</span><br/><span class="line">print(&#34;第一种&#34;..site[&#34;key&#34;])</span><br/><span class="line">--第二种方法</span><br/><span class="line">print(&#34;第二种&#34;..site.key)</span><br/></pre></td></tr></tbody></table></figure>
<p>输出结果：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/></pre></td><td class="code"><pre><span class="line">第一种thbelief</span><br/><span class="line">第二种thbelief</span><br/></pre></td></tr></tbody></table></figure>
<h2><span id="循环">循环</span></h2><table>
<thead>
<tr>
<th style="text-align:left">循环类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="http://www.runoob.com/lua/lua-while-loop.html" target="_blank" rel="noopener noreferrer">while 循环</a></td>
<td style="text-align:left">在条件为 true 时，让程序重复地执行某些语句。执行语句前会先检查条件是否为 true。</td>
</tr>
<tr>
<td style="text-align:left"><a href="http://www.runoob.com/lua/lua-for-loop.html" target="_blank" rel="noopener noreferrer">for 循环</a></td>
<td style="text-align:left">重复执行指定语句，重复次数可在 for 语句中控制。</td>
</tr>
<tr>
<td style="text-align:left"><a href="http://www.runoob.com/lua/lua-repeat-until-loop.html" target="_blank" rel="noopener noreferrer">repeat…until</a></td>
<td style="text-align:left">重复执行循环，直到 指定的条件为真时为止</td>
</tr>
<tr>
<td style="text-align:left"><a href="http://www.runoob.com/lua/lua-nested-loops.html" target="_blank" rel="noopener noreferrer">循环嵌套</a></td>
<td style="text-align:left">可以在循环内嵌套一个或多个循环语句（while do … end;for … do … end;repeat … until;）</td>
</tr>
</tbody>
</table>
<p><img src="https://thbelief.github.io//2019/04/20/Lua学习笔记-二/循环.jpg" alt=""/></p>
<h3><span id="控制语句">控制语句</span></h3><p><strong>Break：退出当前循环或语句。</strong></p>
<h2><span id="流程控制">流程控制</span></h2><p><strong>需要特别注意，在Lua中0是true。</strong></p>
<p><strong>在Lua中，只有nil和false为假！</strong></p>
<p>if语句、if…else语句、if的嵌套语句。</p>
<h2><span id="函数">函数</span></h2><p>Lua中函数的定义：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">optional_function_scope function function_name( argument1, argument2, argument3..., argumentn)</span><br/><span class="line">    function_body</span><br/><span class="line">    return result_params_comma_separated</span><br/><span class="line">end</span><br/></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>optional_function_scope:</strong> 该参数是可选的制定函数是全局函数还是局部函数，未设置该参数默认为全局函数，如果你需要设置函数为局部函数需要使用关键字 <strong>local</strong>。</li>
<li><strong>function_name:</strong> 指定函数名称。</li>
<li><strong>argument1, argument2, argument3…, argumentn:</strong> 函数参数，多个参数以逗号隔开，函数也可以不带参数。</li>
<li><strong>function_body:</strong> 函数体，函数中需要执行的代码语句块。</li>
<li><strong>result_params_comma_separated:</strong> 函数返回值，Lua语言函数可以返回多个值，每个值以逗号隔开。</li>
</ul>
<h3><span id="可变参数">可变参数</span></h3><p>和c语言类似，Lua中用<strong>…</strong>表示函数有可变的参数。</p>
<ul>
<li><strong>select(‘#’, …)</strong> 返回可变参数的长度</li>
<li><strong>select(n, …)</strong> 用于访问 <strong>n</strong> 到 <strong>select(‘#’,…)</strong> 的参数</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/></pre></td><td class="code"><pre><span class="line">function add(...)--这里使用...表示可变参数</span><br/><span class="line">local s=0</span><br/><span class="line">for i,v in ipairs{...} do</span><br/><span class="line">    s=s+v</span><br/><span class="line">end</span><br/><span class="line">print(&#34;可变参数数量：&#34;..select(&#34;#&#34;, ...))</span><br/><span class="line">return s</span><br/><span class="line">end</span><br/><span class="line">print(add(1,2,3,4))</span><br/></pre></td></tr></tbody></table></figure>
<p><img src="https://thbelief.github.io//2019/04/20/Lua学习笔记-二/可变参数.jpg" alt=""/></p>
<h2><span id="运算符">运算符</span></h2><h3><span id="算术运算符">算术运算符</span></h3><table>
<thead>
<tr>
<th style="text-align:left">操作符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">加法</td>
<td style="text-align:left">A + B 输出结果 30</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">减法</td>
<td style="text-align:left">A - B 输出结果 -10</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">乘法</td>
<td style="text-align:left">A * B 输出结果 200</td>
</tr>
<tr>
<td style="text-align:left">/</td>
<td style="text-align:left">除法</td>
<td style="text-align:left">B / A w输出结果 2</td>
</tr>
<tr>
<td style="text-align:left">%</td>
<td style="text-align:left">取余</td>
<td style="text-align:left">B % A 输出结果 0</td>
</tr>
<tr>
<td style="text-align:left">^</td>
<td style="text-align:left">乘幂</td>
<td style="text-align:left">A^2 输出结果 100</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">负号</td>
<td style="text-align:left">-A 输出结果v -10</td>
</tr>
</tbody>
</table>
<p>由于太简单了，这里就不写例子了。</p>
<h3><span id="关系运算符">关系运算符</span></h3><table>
<thead>
<tr>
<th style="text-align:left">操作符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">==</td>
<td style="text-align:left">等于，检测两个值是否相等，相等返回 true，否则返回 false</td>
<td style="text-align:left">(A == B) 为 false。</td>
</tr>
<tr>
<td style="text-align:left">~=</td>
<td style="text-align:left">不等于，检测两个值是否相等，相等返回 false，否则返回 true</td>
<td style="text-align:left">(A ~= B) 为 true。</td>
</tr>
<tr>
<td style="text-align:left">&gt;</td>
<td style="text-align:left">大于，如果左边的值大于右边的值，返回 true，否则返回 false</td>
<td style="text-align:left">(A &gt; B) 为 false。</td>
</tr>
<tr>
<td style="text-align:left">&lt;</td>
<td style="text-align:left">小于，如果左边的值大于右边的值，返回 false，否则返回 true</td>
<td style="text-align:left">(A &lt; B) 为 true。</td>
</tr>
<tr>
<td style="text-align:left">&gt;=</td>
<td style="text-align:left">大于等于，如果左边的值大于等于右边的值，返回 true，否则返回 false</td>
<td style="text-align:left">(A &gt;= B) 返回 false。</td>
</tr>
<tr>
<td style="text-align:left">&lt;=</td>
<td style="text-align:left">小于等于， 如果左边的值小于等于右边的值，返回 true，否则返回 false</td>
<td style="text-align:left">(A &lt;= B) 返回 true。</td>
</tr>
</tbody>
</table>
<p>这里需要注意的就是~=，和其它高级语言使用的！=不同，<strong>Lua中用~=表示不等于。</strong></p>
<h3><span id="逻辑运算符">逻辑运算符</span></h3><table>
<thead>
<tr>
<th style="text-align:left">操作符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">and</td>
<td style="text-align:left">逻辑与操作符。 若 A 为 false，则返回 A，否则返回 B。</td>
<td style="text-align:left">(A and B) 为 false。</td>
</tr>
<tr>
<td style="text-align:left">or</td>
<td style="text-align:left">逻辑或操作符。 若 A 为 true，则返回 A，否则返回 B。</td>
<td style="text-align:left">(A or B) 为 true。</td>
</tr>
<tr>
<td style="text-align:left">not</td>
<td style="text-align:left">逻辑非操作符。与逻辑运算结果相反，如果条件为 true，逻辑非为 false。</td>
<td style="text-align:left">not(A and B) 为 true。</td>
</tr>
</tbody>
</table>
<h3><span id="其它运算符">其它运算符</span></h3><table>
<thead>
<tr>
<th style="text-align:left">操作符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">..</td>
<td style="text-align:left">连接两个字符串</td>
<td style="text-align:left">a..b ，其中 a 为 “Hello “ ， b 为 “World”, 输出结果为 “Hello World”。</td>
</tr>
<tr>
<td style="text-align:left">#</td>
<td style="text-align:left">一元运算符，返回字符串或表的长度。</td>
<td style="text-align:left">#”Hello” 返回 5</td>
</tr>
</tbody>
</table>
<p>这两个其它运算符之前提过，这里就不详细描述了。</p>
<h3><span id="优先级">优先级</span></h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">^</span><br/><span class="line">not    - (unary)</span><br/><span class="line">*      /</span><br/><span class="line">+      -</span><br/><span class="line">..</span><br/><span class="line">&lt;      &gt;      &lt;=     &gt;=     ~=     ==</span><br/><span class="line">and</span><br/><span class="line">or</span><br/></pre></td></tr></tbody></table></figure>
<h2><span id="字符串">字符串</span></h2><h3><span id="转义字符">转义字符</span></h3><table>
<thead>
<tr>
<th>转义字符</th>
<th>意义</th>
<th>ASCII码值（十进制）</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>响铃(BEL)</td>
<td>007</td>
</tr>
<tr>
<td>b</td>
<td>退格(BS) ，将当前位置移到前一列</td>
<td>008</td>
</tr>
<tr>
<td>f</td>
<td>换页(FF)，将当前位置移到下页开头</td>
<td>012</td>
</tr>
<tr>
<td>n</td>
<td>换行(LF) ，将当前位置移到下一行开头</td>
<td>010</td>
</tr>
<tr>
<td>r</td>
<td>回车(CR) ，将当前位置移到本行开头</td>
<td>013</td>
</tr>
<tr>
<td>t</td>
<td>水平制表(HT) （跳到下一个TAB位置）</td>
<td>009</td>
</tr>
<tr>
<td>v</td>
<td>垂直制表(VT)</td>
<td>011</td>
</tr>
<tr>
<td></td>
<td>代表一个反斜线字符’’’</td>
<td>092</td>
</tr>
<tr>
<td>’</td>
<td>代表一个单引号（撇号）字符</td>
<td>039</td>
</tr>
<tr>
<td>”</td>
<td>代表一个双引号字符</td>
<td>034</td>
</tr>
<tr>
<td>