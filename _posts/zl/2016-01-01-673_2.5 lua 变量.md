---
layout: post
title: 2.5 lua 变量 
tags: [lua文章]
categories: [topic]
---
<h2 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h2><h3 id="创建一个全局变量"><a href="#创建一个全局变量" class="headerlink" title="创建一个全局变量"></a>创建一个全局变量</h3><p>全局变量不需要声明，给一个变量赋值即创建了一个全局变量，访问一个没有初始化的变量（默认是全局变量，即，lua的变量默认是全局变量，特别注意）也不会出错，会返回<code>nil</code>。<br/></p><figure class="highlight lua"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(var_a) </span><br/><span class="line">var_a = <span class="number">10</span></span><br/><span class="line"><span class="built_in">print</span>(var_a) <span class="comment">-- 10</span></span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>在命令模式中执行如下：<br/></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio</span><br/><span class="line"> print(var_a)</span><br/><span class="line">nil</span><br/><span class="line"></span><br/></pre></td></tr></tbody></table></figure><p></p>
<h3 id="删除一个全局变量"><a href="#删除一个全局变量" class="headerlink" title="删除一个全局变量"></a>删除一个全局变量</h3><p>删除一个变量很简单，直接将改变量赋值为<code>nil</code>;如下面的例子：b是全局变量，当赋值为<code>nil</code>之后，再调用<code>print</code>就会返回<code>nil</code>。<br/></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/></pre></td><td class="code"><pre><span class="line">Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio</span><br/><span class="line"> b = 1; print(&#34;b=&#34; .. b); b = nil; print(b);</span><br/><span class="line">b=1</span><br/><span class="line">nil</span><br/><span class="line"></span><br/></pre></td></tr></tbody></table></figure><p></p>
<p>总之，可以这么理解：当一个变量被赋值为<code>nil</code>，这个变量就变得像从来没出现过一样，换句话说，<strong>只有当一个变量的值不是<code>nil</code>这个变量才是存在的</strong>。</p>
<h2 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h2><p>使用<code>local</code> 关键字来声明一个局部变量，和其他语言一样，局部变量只在被声明的那个代码块中有效。代码块包括：</p>
<ol>
<li>控制结构</li>
<li>函数体</li>
<li>chunk（变量被声明的那个文件或者文本串</li>
</ol>
<p><strong>注意</strong>:命令行模式中每一行就是一个chunk,也就是说，上一行的局部变量下一行就不可见了。<br/></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio</span><br/><span class="line"> a = 1 -- 全局变量</span><br/><span class="line"><span class="meta">&gt;</span> print(a)</span><br/><span class="line">1</span><br/><span class="line"><span class="meta">&gt;</span> local b = 2 -- 局部变量</span><br/><span class="line"><span class="meta">&gt;</span> print(b)</span><br/><span class="line">nil</span><br/><span class="line"><span class="meta">&gt;</span></span><br/></pre></td></tr></tbody></table></figure><p></p>
<h3 id="使用do-end"><a href="#使用do-end" class="headerlink" title="使用do ... end"></a>使用<code>do ... end</code></h3><p>使用<code>do ... end</code>可以给一个block一个明确的边界。<br/></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/></pre></td><td class="code"><pre><span class="line">Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio</span><br/><span class="line"><span class="meta">&gt;</span> a = 1 --全局变量</span><br/><span class="line"><span class="meta">&gt;</span> local b = 2 -- 局部变量</span><br/><span class="line"><span class="meta">&gt;</span> do</span><br/><span class="line"><span class="meta">&gt;</span>&gt; local c = a * 3 --局部变量</span><br/><span class="line"><span class="meta">&gt;</span>&gt; print(a)</span><br/><span class="line"><span class="meta">&gt;</span>&gt; print(b)</span><br/><span class="line"><span class="meta">&gt;</span>&gt; print(c)</span><br/><span class="line"><span class="meta">&gt;</span>&gt; end</span><br/><span class="line">1</span><br/><span class="line">nil</span><br/><span class="line">3</span><br/><span class="line"><span class="meta">&gt;</span></span><br/></pre></td></tr></tbody></table></figure><p></p>