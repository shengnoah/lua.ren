---
layout: post
title: Nginx安装Lua模块 
tags: [lua文章]
categories: [topic]
---
### NGINX安装LUA（基于LNMP）：

1.下载安装LuaJIT 2.1：<http://luajit.org/download.html>

    
    
    1  
    2  
    3  
    4  
    5  
    

|

    
    
    wget http://luajit.org/download/LuaJIT-2.1.0-beta3.tar.gz  
    tar zxf LuaJIT-2.1.0-beta3.tar.gz  
    cd LuaJIT-2.1.0-beta3  
    make PREFIX=/usr/local/luajit  
    make install PREFIX=/usr/local/luajit  
      
  
---|---  
  
2.下载最新的ngx_devel_kit（NDK）模块：<https://github.com/simpl/ngx_devel_kit/tags>

    
    
    1  
    2  
    

|

    
    
    wget https://github.com/simpl/ngx_devel_kit/archive/v0.3.0.tar.gz  
    tar -xzvf v0.3.0.tar.gz  
      
  
---|---  
  
3.下载最新的lua-nginx-module 模块：<https://github.com/openresty/lua-nginx-
module/tags>

    
    
    1  
    2  
    

|

    
    
    wget https://github.com/openresty/lua-nginx-module/archive/v0.10.11.tar.gz  
    tar -xzvf v0.10.11.tar.gz  
      
  
---|---  
  
然后执行以下命令

    
    
    1  
    2  
    3  
    

|

    
    
      
    export LUAJIT_LIB=/usr/local/luajit/lib  
    export LUAJIT_INC=/usr/local/luajit/include/luajit-2.1  
      
  
---|---  
  
接下来我们就要开始升级nginx版本了，在升级nginx版本之前，想进入lnmp的解压包，我们要在lnmp一键包目录下的lnmp.conf文件里的Nginx_Modules_Options加上编译参数：

    
    
    1  
    

|

    
    
    Nginx_Modules_Options='--with-ld-opt=-Wl,-rpath,/usr/local/luajit/lib --add-module=/root/lua-nginx-module-0.10.11 --add-module=/root/ngx_devel_kit-0.3.0'  
      
  
---|---  
  
加上以上这段参数之后，我们就使用lnmp一键包中的./upgrade.sh
nginx升级脚本升级一遍nginx即可完成lua扩展的安装。等重新编译完，nginx中就能使用lua扩展了。